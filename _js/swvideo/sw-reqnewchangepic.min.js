$(".ui.dropdown").dropdown();
$(".menu .item").tab();

// Global Variable
const NonceValue = "rdsystem2020";
const LogoutProtect = false;

const ColorSignNo  = "#00139f";
const ColorOwner  = "#00139f";
const BgColorOwner  = "#eff0ff";
const ColorFinish= "#505050";
const ColorCancel = "#be0000";
const ColorLock = "#860954";
const BgColorLock = "#f3ebeb";

var vusrnm = getCookie("usrnm");
var vtoken = getCookie("token");
var restlocmkg = decodeURIComponent(getCookie("restlocmkg"));
var restlocswrelease = decodeURIComponent(getCookie("restlocswrelease"));
let Ucrypt = new Encryption();
var Udecrypt = Ucrypt.decrypt(EncU, NonceValue);


  function readromrelease(){
    // $('#inputNoAktivaMutasi').on('change', function(e){
        $.ajax({
          type: "POST",
          url: `${restlocswrelease}readromrelease`,
          async: false,
          headers: {
            user: vusrnm,
            token: vtoken,
          },
          data: {
            pic: Udecrypt,
            user: vusrnm,
          },
          cache: false,
          success: function (response) {
            var obj = JSON.parse(response);
            jmlData = obj.length;
            if (obj.status == false) {
              IsResponseFalse(obj.message);
            } else {
              $('.ui.dropdown.fullsearch').dropdown( {fullTextSearch:'exact', sortSelect: true, match:'text'} );
              $('#inputNoAktivaMutasi').dropdown('clear');
              $('#inputNoAktivaMutasi').empty();
              $('#inputNoAktivaMutasi').append(`<option value=""></option>`);
            for (a = 0; a < jmlData; a++) {
                $('#inputNoAktivaMutasi').append(`<option value="${obj[a]['id']}">${obj[a]['type']} (${obj[a]['rom']}) - ${obj[a]['pic']}</option>`);
              }
            }
          },
          error: function () {
            IsTimeOut(LogoutProtect);
          },
        });
    
      // });
      
    
  }

  $('#inputNoAktivaMutasi').on('change', function() {
    $.ajax({
      type    : "POST",
      url     : `${restlocswrelease}get_romrelease`,
      headers : {
        user  : vusrnm,
        token : vtoken
      },
      data: {
        id    : $("#inputNoAktivaMutasi").val(),
        // $("#AddItemPlant").val().toString();
      },
      cache: false,
      success: function (response){
        var obj = JSON.parse(response);
        if(isEmpty(obj)) {
          IsResponseEmptyObj();
        } else if(obj) {
          if (obj.status == false){
            IsResponseFalse(obj.message);
          } else {
            // IsResponseTrue(obj.message);
            $("#chasis").val(obj[0]['chasis']);
            $("#rom").val(obj[0]['rom']);
            $("#type").val(obj[0]['type']);
            // window.location.href = "./?link=swvideoindex";
          }
        } else {
          Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
        }
      },
      error: function () {
        if (LogoutProtect){
          window.location.href = "./?link=loclogout";
        } else {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
        }
      },
    });
  });

  $('#HeaderButtonSave').on('click', function() {
    $.ajax({
      type    : "POST",
      url     : `${restlocswrelease}CreateChangePic`,
      headers : {
        user  : vusrnm,
        token : vtoken
      },
      data: {
        id            : $("#inputNoAktivaMutasi").val(),
        chasis        : $("#chasis").val(),
        rom           : $("#rom").val(),
        pic_lama      : $("#pic_lama").val(),
        pic_baru      : $("#pic_baru").val(),
        type          : $("#type").val(),
        // $("#AddItemPlant").val().toString();
      },
      cache: false,
      success: function (response){
        var obj = JSON.parse(response);
        if(isEmpty(obj)) {
          IsResponseEmptyObj();
        } else if(obj) {
          if (obj.status == false){
            IsResponseFalse(obj.message);
          } else {
            IsResponseTrue(obj.message);
            window.location.href = "./?link=swchangepic";
          }
        } else {
          Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
        }
      },
      error: function () {
        if (LogoutProtect){
          window.location.href = "./?link=loclogout";
        } else {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
        }
      },
    });
  });

$(document).ready(function () {
  readromrelease();
  $("#addnewproject").on("click", function () {
    window.location.href = "./?link=swvideoreqchangepic";
  });

  $('#userguidemkg').on('click', function() {
    window.location.href = "./?link=guidemkg";
  });

  $('#tabTimeline').on('click', function() { 
    window.location.href = "./?link=mkgtimeline";
  });

  $('#tabcreateproject').on('click', function() { 
    window.location.href = "./?link=swvideoindex";
  });

  $('#tabappsetting').on('click', function() { 
    window.location.href = "./?link=swappsetting";
  });

  $('#tabchangepic').on('click', function() { 
    window.location.href = "./?link=swchangepic";
  });

  $('.CancelData').click(function(){
    $(".xwinaddnewpic").modal("hide");
    $(".xwinaddnewemailreceiver").modal("hide");
  });

  
  //Load Table
  TableListFunc();


});