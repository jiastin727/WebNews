$('.ui.dropdown').dropdown();
var restlocswrelease = decodeURIComponent(getCookie("restlocswrelease"));

var vusrnm = getCookie("usrnm");
var vtoken = getCookie("token");
const NonceValue = "rdsystem2020";
const LogoutProtect = false;


$(document).ready(function() {

  $('#tabEANReq').on('click', function() {
    window.location.href = "./?link=swvideoindex";
  });

  $('#tabMKG').on('click', function() {
    window.location.href = "./?link=swvideoindex";
  });

  $('#DownloadTemplate').on('click', function() {
    $.ajax({
      type    : "GET",
      url     : `${restlocswrelease}dummy-type`,
      headers : {
        user  : vusrnm,
        token : vtoken
      },
      cache: false,
      success: function (response){
        var obj = JSON.parse(response);
        if(isEmpty(obj)) {
          IsResponseEmptyObj();
        } else if(obj) {
          if (obj.status == false){
            IsResponseFalse(obj.message);
          } else {
            // IsResponseTrue(obj.message);
            window.location.href = '../RND_BackEnd/backend_mkg/template-type';
          }
        } else {
          Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
        }
      },
      error: function () {
        if (LogoutProtect){
          window.location.href = "./?link=loclogout";
        } else {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
        }
      },
    });
  });
  // $("#DownloadTemplate").on("click", function (e) {
  //   $.ajax({
  //     type    : "GET",
  //     url     : window.location.href = '../RND_BackEnd/backend_mkg/template-type',
  //     headers : {
  //       user  : vusrnm,
  //       token : vtoken
  //     },
  //   });
    
  // });

  $('#HeaderButtonBack').on('click', function() {
    window.location.href = "./?link=swvideoindex";
  });

  $('#userguidemkg').on('click', function() {
    window.location.href = "./?link=guidemkg";
  });

  $(".CloseModal").on("click", function (e) {
    $(".xwinuploadtype").modal("hide");
  });

  $("#EANBasic").on("input", function() {
    $('#EANSite').val('');
    $('#EANBrand').val('');
    $('#EANJenisProduct').val('');
    $('#EANProduct').val('');
  });

  $('#LoadTypeSupply').on('click', function() {
    LoadDataPTB();
    // LoadDataPTB();
  });

  function GetValue(a){
    if(a){
      return a;
    } else {
      return '';
    }
  }


  function LoadDataPTB(){
    var itype = $('#TypeBarangDemand').val();
    if(itype){
      $('.PTBInput').addClass('loading');
      $.ajax({
        type    : "POST",
        url     : `${restlocswrelease}LoadDataTypeBarangDemand`,
        headers : {
          user  : vusrnm,
          token : vtoken
        },
        data: {
          tbarangdemand    : itype,
          usernames  : vusrnm,
        },
        cache: false,
        success: function (response){
          var obj = JSON.parse(response);
          if(obj.status == false){
            IsResponseFalse(obj.message);
          }
          $('#TypeBarangDemand').val('');
        },
        error: function () {
          if (LogoutProtect){
            window.location.href = "./?link=loclogout";
          } else {
            Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
          }
        },
      });
    }
  }

  //fungsi tampilkan kalender pop-up
  $('[data-toggle="datepicker"]').datepicker({
    format: 'yyyy-mm-dd',
    autoHide : true,
    weekStart: 1
  });
  
  


  $('#HeaderButtonSave').on('click', function() {
    $.ajax({
      type    : "POST",
      url     : `${restlocswrelease}CreateROM`,
      headers : {
        user  : vusrnm,
        token : vtoken
      },
      data: {
        Id         : IdEdit,
        TypeSupply    : $("#TypeBarangDemand").val(),
        chasis        : $("#chasis").val(),
        pass1         : $("#pass1").val(),
        pass2         : $("#pass2").val(),
        pass3         : $("#pass3").val(),
        RomNote       : $("#RomNote").val(),
        PICSW       : $("#PICSW").val(),
        // $("#AddItemPlant").val().toString();
      },
      cache: false,
      success: function (response){
        var obj = JSON.parse(response);
        if(isEmpty(obj)) {
          IsResponseEmptyObj();
        } else if(obj) {
          if (obj.status == false){
            IsResponseFalse(obj.message);
          } else {
            IsResponseTrue(obj.message);
            window.location.href = "./?link=swvideoindex";
          }
        } else {
          Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
        }
      },
      error: function () {
        if (LogoutProtect){
          window.location.href = "./?link=loclogout";
        } else {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
        }
      },
    });
  });

  $("#SubmitUpload").on("click", function () {
    var file_data = $("#UploadFileXls").prop("files")[0];
    var form_data = new FormData();
    form_data.append("file", file_data);
    form_data.append("Username", vusrnm);
    $.ajax({
      type: "POST",
      dataType: "text",
      contentType: false,
      processData: false,
      url: `../RND_BackEnd/backend_mkg/upload-type`,
      headers: {
        user: vusrnm,
        token: vtoken,
      },
      data: form_data,
      cache: false,
      success: function (response) {
        var obj = JSON.parse(response);
        if (obj.status == false) {
          IsResponseFalse(obj.message);
        } else {
          IsResponseTrue(obj.message);
          $(".xwinuploadtype").modal("hide");
        }
      },
      error: function () {
        IsTimeOut(LogoutProtect);
      },
    });
  });


  // //Cancel EAN Request 
  // $('#HeaderButtonCancel').on('click', function() {
  //   var idid = $('#EANIdEdit').val();

  //   Swal.fire({
  //     title: "<h3>Cancel Permintaan EAN Barcode ini ?</h3>",
  //     icon: "warning",
  //     confirmButtonText: "Ya",
  //     showCancelButton: true,
  //   }).then((result) => {
  //     if (result.value) {
  //       $.ajax({
  //         type: "POST",
  //         url: `${restlocean}Cancel_EAN`,
  //         headers: {
  //           user: vusrnm,
  //           token: vtoken,
  //         },
  //         data: {
  //           IdNum    : idid,
  //         },
  //         cache: false,
  //         success: function (response) {
  //           var obj = JSON.parse(response);
  //           if (obj.status == false) {
  //             Swal.fire({
  //               text: obj.message,
  //               timer: 1500,
  //               icon: 'warning',
  //               showConfirmButton: false
  //             })
  //           } else {
  //             Swal.fire({
  //               text: obj.message,
  //               timer: 1500,
  //               icon: 'success',
  //               showConfirmButton: false
  //             });
  //             window.location.href = "./?link=eanindex";
  //           }
  //         },
  //         error: function () {
  //           if (LogoutProtect){
  //             window.location.href = "./?link=loclogout";
  //           } else {
  //             Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
  //           }
  //         },
  //       });
  //     }
  //   });

  // });


   //type basic autocomplete
   $(".ui.search.tbasic").search({
    minCharacters: 1,
    apiSettings: {
      url: "1_swrelease/_autocompletetypebasic.php?tsupply={query}",
    },
    fields: {
      results: "data",
      title: "type_mfg_supply",
      // description: "desc",
    },
    
  });

  // $('.ui.dropdown.fullsearch').dropdown( {fullTextSearch:'exact', sortSelect: true, match:'text'} );




});

