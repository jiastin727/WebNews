var restlocmdschecker = "../RND_BackEnd/backend_mds_dinamis/";

function tableChecker(){

    var UCookie = getKeepCookie("usrnm");
    var TCookie = getKeepCookie("token");
    $.ajax({
      type: "POST",
      url : `${restlocmds}table_checker`,
      headers: {
        user: UCookie,
        token: TCookie,
      },
      data: {
        idtab: id_tab,
        idsub: id_sub,
        nama_tabel : nama_tabel_loaded,
        tab_up_date: tab_up_date,
        sub_up_date: sub_up_date,
        setting_up_date: setting_up_date,
      },
      cache: false,
      success: function (response) {
        
        var obj = JSON.parse(response);
        if(isEmpty(obj)) {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      
      } else if(obj.status==false) {
      // tableType();
        

        if(obj.isalert){

          Swal.fire({
            title: obj.message,
            icon: 'warning',
            text: "klik refresh untuk melihat perubahan",
            // showDenyButton: true,
            // showCancelButton: true,
            confirmButtonText: 'refresh',
            // denyButtonText: `tumpuk data lama`,
            // confirmButtonColor: '#21ba45',
            // confirmButtonColor: '#3085d6',
          }).then((result) => {
            location.reload(); // force reload
            if (result.isConfirmed) {
                location.reload();
            }
        
          })

        }else{
          location.reload();

        }
          // Swal.fire({
          //     title: obj.message,
          //     text: "",
          //     icon: 'error',
          //     showCancelButton: false,
          //     confirmButtonText: 'Ya',
          // });

      } else {

        setTimeout("tableChecker()", 10000);
      
      }
        
      },
      error: function () {
        if (LogoutProtectCond){
          window.location.href = "./?link=loclogout";
        } else {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
        }
      },
    });
  } 
  
  $(function(){ 
    tableChecker();  
  });