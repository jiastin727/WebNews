// KUMPULAN FUNGSI MEMANGGIL AJAX
// CARI: KUMPULAN AJAX

$(".ui.dropdown").dropdown();
$(".menu.item").tab();
$('.ui.dropdown').dropdown({
    forceSelection:false
});
$('#AddHeaderPrjID').dropdown({
  forceSelection:false
});

$(".ui.calendar")
  .calendar();
  datepick();
  

const fungsilogout = false;
var vusrnm = getCookie("usrnm");
var vtoken = getCookie("token");
var restlocdocmgmt = decodeURIComponent(getCookie("restlocdocmgmt"));
let jenis_type="PLACEHOLDER";
let enable_edit=true;
// COOKIE UNTUK MENYIMPAN HISTORY LINK HALAMAN UPLOAD

var json_cookies = getCookie('linkupl');

if(json_cookies){
    var hasiljson = json_cookies;
  var link_ck= json_cookies;
  
}

if(link_ck){
    
        $('#mechupload').removeClass("disabled");
        $("#mechupload").on("click", function(){
            //store data baris
            // var eid = $(this).attr("btnid");
            // let encryption = new Encryption();
            // var eidENC = encryption.encrypt(eid, NonceValue);
            // window.location.href = "./?link=dalamnegeridetail&i=" + eidENC;
            console.log("uplod")
            window.location.href = link_ck;
        });

}

// COOKIES CLEAR TEMP ATAU TIDAK
// JIKA DARI EDIT->CLEAR TEMP


var json_addOrEdit = getCookie('addOrEdit');

// if(json_cookies){
//     var hasiljson = json_cookies;
//   var link_ck= json_cookies;
  
// }

if(json_addOrEdit){
  
  // ada cookies
  if(fungsiedit){
      // masuk untuk edit header

      if(json_addOrEdit==="ADD"){
        // sebelumnya tambah header-->clear temp
        // cleartype_temp();
        // tableType();
      }else if(json_addOrEdit==="EDIT"){
        // sebelumnya edit-->clear temp
        // cleartype_temp();
        // tableType();
      }

      setCookie("addOrEdit",'EDIT',5);
      viewupdatefunc(idproject);

  }else{
      // masuk untuk tambah header
      $('#groupProd_in').dropdown('set selected', "MDID");
      isidropsub("MDID",false);

      if(json_addOrEdit==="ADD"){
        // sebelumnya tambah header-->tidak clear temp type
        clearDesignerTemp();
        tableType("cookieadd");

      }else if(json_addOrEdit==="EDIT"){
        // sebelumnya edit-->clear temp

        cleartype_temp();
        clearDesignerTemp();
        

      }
      
      setCookie("addOrEdit",'ADD',5);

  }
    
  // bila ada cookiesnya
  console.log(json_addOrEdit);

}else{
  cleartype_temp();
  clearDesignerTemp();
  // tableType();
  // bila tidak ada cookies
  if(fungsiedit){
    setCookie("addOrEdit",'EDIT',5);
    viewupdatefunc(idproject);
  }else{
    setCookie("addOrEdit",'ADD',5);
  }
  


}



function inArray(needle, haystack) {
  console.log(needle,haystack);
  var length = haystack.length;
  for(var i = 0; i < length; i++) {
      if(haystack[i] == needle) return true;
  }
  return false;
}



// ------ VARIABEL VARIABLE
var arrtype=[];
var counttype=0;
let allow_clickbtn=true;

//---BUTTON CLICK
//--------TAB

$("#mechreport").on("click", function(){
  console.log("uplod")
  window.location.href = "./?link=mechdocrep";
});

$('#mechproject').on('click', function() {
    window.location.href = "./?link=mechdocmanagement";
});

$('#mechsearch').on('click', function() {
  window.location.href = "./?link=mechdocsearch";
});
 
$('.tabuserguide').on('click', function() {
  window.location.href = "./?link=guidemecdoc";
});
$('.tabsuratgolive').on('click', function() {
  window.location.href = "./?link=golivemecdoc";
});
$('.tabhasilmonitoring').on('click', function() {
  window.location.href = "./?link=monitormecdoc";
});
$('.tabversion').on('click', function() {
  window.location.href = "./?link=versionhistory&app=DMN";
});


$("#HeaderButtonSave.allowed").click(function(){

  simpanheader();
})

$("#HeaderButtonEdit.allowed").click(function(){

  editheader();
})
$('#HeaderButtonBack').on('click', function() {
  window.location.href = "./?link=mechdocmanagement";
});

$('.CancelData').on('click', function() {
  $('.windowdesigner').modal('hide');
});

$(document).on('click','.edittype', function() {

  if(allow_clickbtn){
    let idtype=$(this).attr('editid');

    $(".ui.calendar")
    .calendar();
    datepick();
    
    handler_openmodal_type('UPDATE',idtype);
  }
  
});

$('#addtype').on('click', function() {
  
  
  $(".ui.calendar")
  .calendar();
  datepick();
  
  
  handler_openmodal_type('NEW','');
});


$('#AddItemButtonBack').on('click', function(e){
  $(".WindowPrjID").modal('hide');
});

$('#AddItemButtonSave').on('click', function(e){
  $(".WindowPrjID").modal('hide');
  
  write_msproject();
});

$('.closemodal_btn').on('click', function() {
  let namamodal=$(this).attr('modalname');
  $('.'+namamodal).modal('hide');
  // $('.uploaddvr').modal('hide');
});

// ON LOAD -  DOCUMENT READY -LOAD KETIKA HALAMAN DIBUKA

$( document ).ready(function() {

  
  // $('.typemodal').modal({
    
  // });

  // $(".WindowPrjID").modal({
  //   // allowMultiple:true,
  //   // autofocus: false,
    
    
  // });

  $('.keepopen.modal').modal({
    allowMultiple: true,
    closable:false,
    keyboardShortcuts: false
  });

  // MENENTUKAN KONDISI HALAMAN PADA FUNGSI ADD HEADER ATAU EDIT HEADER
  if(fungsiedit){
    // kondisi edit
    // viewupdatefunc(idproject);
 
  }else{
    // SETTING INPUT PRODUCT
// ---- GROUP PRODUCT OPTION
    $("body").on('change', '#groupProd_in', function(){
      var groupval=$("#groupProd_in").val();
      console.log(groupval);

      isidropsub(groupval,false);

        $('.ui.dropdown.subprod').removeClass("disabled disabledin");
        $('#subproddiv').removeClass("disabledin");
      
    });
    // kondisi add/tambah
    // membersihkan table temp  designer
    // deletetemptype();
    // cleartype_temp();
    // clearDesignerTemp();
    // tableType();
  }
  // deletetemptype();
  // clearTemp();
  tablelistPTB2("");
  

  $('.ui .dropdown').dropdown({
    forceSelection:false
  })
  
  if($("#groupProd_in").val()==""){
    console.log($("#groupProd_in").val());
    console.log($(".ui.dropdown.subprod > .default.text").text());
    // $("#subProd_in").prop("disabled",true);
        // document.getElementById("subProd_in").placeholder = "pilih group product terlebih dahulu";
        $('.ui.dropdown.subprod').addClass("disabled disabledin");
        $('#subproddiv').addClass("disabledin");
        $('#subProd_in').dropdown({placeholder:'TESTT'});
        // $('#subProd_in').append(new Option("pilih group product terlebih dahulu", " "))
  }
});



// SET VALUE TYPE REFF
function setreff(input){
  console.log(input);
  var refval=$('#MFGsupp_in').val();
  console.log(refval);
  $('#reff_in').val(refval);

  $("#MFGdem_in").val('placeholder');
  $("#lotinv_in").val('placeholder');
  $("#barangdem_in").val('placeholder');
  // $("#reff_in").val('');
}


// ---------PROJECT ID MS PROJECT

$('.actprjid').on('click', function(e){

  var vtoken  = getCookie('token');
  var user    = $("#PSSUser").val();
  var idmsprj = $("#HeaderPrjID").val();
  console.log(idmsprj);

  view_msproject();
  // $.ajax({
  //   type: "POST",
  //   url: "./2_psonline/_ajxaddmsprj.php",
  //   data: { user :user, idmsprj:idmsprj },
  //   cache: false,
  //   success: function (response){
  //   },
  //   error: function(){
  //     //window.location.href = "./?link=loclogout";
  //     console.log('Server tidak merespon, segera hubungi Administrator di ext. 3553 !');
  //   }
  // });

    $(".WindowPrjID").modal({
      autofocus: false,
    }).modal('show');

    // LoadMsProject();


    $('.sync').popup({
      on: 'hover',
      // target   : '.syncroo',
      movePopup: false,
    });


    $('.msproject').dropdown({
      fullTextSearch:'exact', 
      match:'both',
      selectOnBlur:false,
      selectOnKeydown: false
    });


  });


  // TOMBOL DELETE DATA MSPROJECT PROJECT ID

  $('body').on('click','.delmsproject',function(){
    var iddel= $(this).attr('delid');
    // var supval = $(this).attr('supval');
    // var dnik= $(this).attr('delnik');
    Swal.fire({
      title: '<h2>Hapus data ini?</h2>',
      text: "",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonText: 'Ya'
    }).then((result) => {
    if (result.value) {
        //REST CALON DNPENYUSUN
        $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}delete_msproject`,
        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data: {
            idmsproject : iddel,
            user : userName1,
        },
        cache: false,
        success: function (response){
            var obj=JSON.parse(response);
          if(isEmpty(obj)) {
            console.log('ERROR: no respond');
            
            
            } else if(obj.status==false) {
            // tableType();
              Swal.fire({
                text: obj.message,  
                // timer: 2500,
                icon: 'error',
                showConfirmButton: true,
                confirmButtonText: 'Ya',
              });
            
            } else {
              view_msproject();
              Swal.fire({
                text: obj.message,  
                timer: 1500,
                icon: 'success',
                showConfirmButton: false,
                // confirmButtonText: 'Ya',
              });
            }

        },
        error: function(){
            if(fungsilogout){

                window.location.href="./_logout.php";
            }else{
                console.log("error session")
            }
        },
        });
    }
    })


});


  $('#AddHeaderPrjID').on('change', function() {
    var proj_identifier     = this.options[this.selectedIndex].getAttribute('value');

    if(proj_identifier==""){

      Swal.fire({
        title: 'error: data kosong',  
        // timer: 2500,
        icon: 'error',
        showConfirmButton: true,
        confirmButtonText: 'Ya',
      });

    }else{

      save_msproject(proj_identifier);

    }
            
    
  });




$("#BtnXApp1").hide();
//--------TAMBAH DESIGNER
$(document).on('click','.plusbtn',function(){

  var urutan = $(this).attr('urutan');
    $('.windowdesigner').modal('show');
    $("#Iddes").val(urutan);
    $("#filtercari").val('');
    tablelistfunc('');

})

$(document).on('click','.deldesigner',function(){
  var Idx     = $(this).attr("urutan");
  var vusrnm  = getCookie('usrnm');
  var vtoken  = getCookie('token');
  
  var desName = $("#designer"+Idx+"").val();
  console.log(desName);

  $.ajax({
       type    : "POST",
       url     : `${restlocdocmgmt}delete_designer_satuan`,
       headers : {
         user  : vusrnm,
         token : vtoken
       },
       data: {
         nama  : desName,
         urutan: Idx,
       },
       cache: false,
       success: function (response){
         var obj = JSON.parse(response);
         // console.log(obj);
         if(isEmpty(obj)) {
           console.log('Gagal Hapus mas brooo, data kosong');
         } else if(obj) {
           if (obj.status == false){
             Swal.fire({
               text: obj.message,  
               timer: 2500,
               icon: 'warning',
               showConfirmButton: false
             });

           } else {

            //  if(Idx=="1"){
               $("#designer"+Idx+"").val('');
               $("#BtnXApp"+Idx+"").hide();
               $("#plusDesbtn"+Idx+"").show();
            
        
          }
         } else {
           Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
         }
       },
       error: function () {
         if (LogoutProtect){
           window.location.href = "./?link=loclogout";
         } else {
           Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
         }
       },
     });
 })


 function handler_openmodal_type(status,idtype){

  if(status==="NEW"){
    // JIKA MENEKAN TOMBOL TAMBAH TYPE 
    $('#tipe_simpan_type').val('NEW');

    $("#MFGsupp_in").val("");
    $("#lotinv_in").val("");
    $("#reff_in").val("");
    $("#MFGdem_in").val("");
    $("#barangdem_in").val("");
    $("#massplan").val("");
    $("#massactual").val("");
    $("#costplan").val("");
    $("#costactual").val("");
    $("#HeaderPrjID").val("");
    $("#TargetMass_in").val("");
    $("#owner_in").val("");
    $("#catatan_type").val("");

    $('.typemodal').modal('show');

  }else if(status==="UPDATE"){
    // JIKA MEMBUKA MODAL DENGAN MENEKAN TOMBOL EDIT
    $('#tipe_simpan_type').val('UPDATE');
    $('#idtype_edit').val(idtype);
    get_type_foredit(idtype);
  }

 }

 function get_type_foredit(idtype){

    disable_action();

    $.ajax({
      type    : "POST",
      url     : `${restlocdocmgmt}table_viewmultitypetemp`,
      headers : {
        user  : vusrnm,
        token : vtoken
      },
      data: {
        idinfotype:idtype,
        username:userName1,
      },
      cache: false,
      success: function (response){
        var obj = JSON.parse(response);
        // console.log(obj);
        if(isEmpty(obj)) {
          console.log('gagal menampilkan data, data kosong');
        } else if(obj) {

          if (obj.status == false){
            Swal.fire({
              text: 'data yang ingin diedit tidak ditemukan',  
              // timer: 2500,
              icon: 'error',
              showConfirmButton: false
            });

          } else {

              jenis_type=obj[0]['jenis_type'];

              $("#MFGsupp_in").val(obj[0]['type_mfg_supply']);
              $("#lotinv_in").val(obj[0]['lot_inventory']);
              $("#reff_in").val(obj[0]['type_ref']);
              $("#MFGdem_in").val(obj[0]['type_mfg_demand']);
              $("#barangdem_in").val(obj[0]['type_barang_demand']);
              $("#massplan").val(obj[0]['masspro_plan']);
              $("#massactual").val(obj[0]['masspro_actual']);
              $("#costplan").val(obj[0]['cost_plan']);
              $("#costactual").val(obj[0]['cost_actual']);
              $("#catatan_type").val(obj[0]['keterangan']);
              // $("#HeaderPrjID").val(obj[0]['type_mfg_supply']);
              // $("#TargetMass_in").val(obj[0]['type_mfg_supply']);
              // $("#owner_in").val(obj[0]['type_mfg_supply']);
              $('.action_type').empty().append(`

              <div class="ui right fluid floated yellow labeled icon button " id="typeedit">
                <i class="edit icon"></i> <span id="d">Update Type</span>
              </div>
              
              `)

              $('.edit_back_type').empty().append(`

              <div class="ui right fluid floated labeled icon button " id="cancel_edit" idtype='`+idtype+`'>
                <i class="arrow left icon"></i> cancel
              </div>
              
              `)

              if(fungsiedit){
                $('#HeaderButtonEdit').removeClass('allowed').addClass('disabled');

              }else{

                $('#HeaderButtonSave').removeClass('allowed').addClass('disabled');
              }

              write_msproject();

              if(obj[0]['id_infotypeutama']==='NEW' || obj[0]['jenis_type']==='PLACEHOLDER'){
                // data merupakan data baru atau placebolder --> type nya bisa diedit
                disable_editmfg(false);

              }else{
                disable_editmfg(true);

              }
              
              // $('.typemodal').modal('show');
      
          }
        } else {
          Swal.fire('Error','Ada kendal di koneksi/database, data tidak ditemukan','error')
        }
      },
      error: function () {
        if (LogoutProtect){
          window.location.href = "./?link=loclogout";
        } else {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
        }
      },
    });

 }


 function disable_editmfg(isdisable){

  if(isdisable){

    enable_edit=false;
      $("#MFGsupp_in").prop('disabled', true);
      $("#MFGsupp_in").removeClass('mandatoryclass').addClass('disabledin');
      $("#infoplace").html(`
        <a class="ui label labelwarning">
        <i class="ui exclamation icon"></i>
          type ini sudah tidak bisa diganti

        </a>
      `);


  }else{

    enable_edit=true;
      $("#MFGsupp_in").prop('disabled', false);
      $("#MFGsupp_in").removeClass('disabledin').addClass('mandatoryclass');
      $("#infoplace").html(`
        
      `);

  }
 }

 $(document).on('click','#cancel_edit',function(){

  let idtype_cancel = $(this).attr('idtype')

    $("#MFGsupp_in").val("");
    $("#lotinv_in").val("");
    $("#reff_in").val("");
    $("#MFGdem_in").val("");
    $("#barangdem_in").val("");
    $("#massplan").val("");
    $("#massactual").val("");
    $("#costplan").val("");
    $("#costactual").val("");
    $("#HeaderPrjID").val("");
    $("#TargetMass_in").val("");
    $("#owner_in").val("");
    $("#catatan_type").val("");

    canceledit(idtype_cancel);

    if(fungsiedit){
      $('#HeaderButtonEdit').removeClass('disabled').addClass('allowed');

    }else{

      $('#HeaderButtonSave').removeClass('disabled').addClass('allowed');
    }

    disable_editmfg(false);
    jenis_type='PLACEHOLDER';

    $('.action_type').empty().append(`

      <div class="ui right fluid floated blue labeled icon button " id="typesave">
        <i class="save icon"></i> <span id="d">simpan info type</span>
      </div>
    
    `)

    $('.edit_back_type').empty();
    

 });

 function canceledit(idtype){

  enable_action();

  $.ajax({
    type    : "POST",
    url     : `${restlocdocmgmt}cancel_edittypetemp`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      idinfotype:idtype,
      user:userName1,
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      // console.log(obj);
      if(isEmpty(obj)) {
        console.log('gagal menampilkan data, data kosong');
      } else if(obj) {

        if (obj.status == false){
          // Swal.fire({
          //   text: 'data yang ingin diedit tidak ditemukan',  
          //   // timer: 2500,
          //   icon: 'error',
          //   showConfirmButton: false
          // });

          console.log('gagal cancel');

        } else {

            
            // $('.typemodal').modal('show');
    
        }
      } else {
        Swal.fire('Error','Ada kendal di koneksi/database, data tidak ditemukan','error')
      }
    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });

}



 // DESIGNER -  TAMPIL TABEL DI MODAL
 function tablelistfunc(Fsearch){

  desplace=$("#Iddes").val();


  $("#designerList").DataTable({
      dom:
        "<'ui stackable grid'" +
        "<'row'" +
        "<'left aligned sixteen wide column'>" +
        ">" +
        "<'row dt-table'" +
        "<'sixteen wide column'tr>" +
        ">" +
        "<'row'" +
        "<'left aligned eight wide column'>" +
        "<'right aligned eight wide column'>" +
        ">" +
        ">",
    
      destroy: true,
      stateSave: false,
      processing: true,
      deferRender: true,
      serverSide: true,
      ordering : true,
      orderClasses: false,
      pageLength: 10,
      data: [],
      language: {
        sLengthMenu: "_MENU_",
        search: "",
        searchPlaceholder: "Search..",
        processing: '<i class="circle notch loading icon huge"></i>',
      },
      columns: [
        {
          data: null,
          render: function (data, type, row) {
            if (data[0] != "") {
              return `<span class="edit outline optionselect selectDes" desName="${data[1]}">`+data[1]+`</span>`;
            } else {
              return "";
            }
          },
        },
        {
          data: null,
          render: function (data, type, row) {
            if (data[0] != "") {
              return `<span class="edit outline optionselect selectDes" desName="${data[1]}">`+data[3]+`</span>`;
            } else {
              return "";
            }
          },
        },
        {
          data: null,
          render: function (data, type, row) {
            if (data[0] != "") {
              return `<span class="edit outline optionselect selectDes" desName="${data[1]}">`+data[4]+`</span>`;
            } else {
              return "";
            }
          },
        },
        
      ],

      ajax: {
        url: `${restlocdocmgmt}table_designer`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          FSearch: Fsearch,
        },
        error: function () {
          if (fungsilogout){
            window.location.href = "./?link=loclogout";
          } else {
            Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
          }
        },
      },
    });

  $("#designerList").css('cursor', 'pointer');
}

$('#filtercari').keyup( function() {
  // var ptbsearch
  // $("#MFGsupp_in").val('');
  // $("#filtercari").val('');
  tablelistfunc($("#filtercari").val());
} );

// DESIGNER - FUNGSI MEMILIH NAMA DESIGNER

$("#designerList").on("click", ".selectDes", function () {

  var desName = $(this).attr("desName");
  var trloc= $(this).closest('tr');
  var urutan = $("#Iddes").val();

  $('.windowdesigner').modal('hide');

  $.ajax({
    type    : "POST",
    url     : `${restlocdocmgmt}create_designertemp`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      // IdUpo    : $("#UPOID").val(),
      namadesigner   : desName,
      urutan    : urutan,
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      console.log(obj);
      if(isEmpty(obj)) {
        console.log('Gagal Simpan');
      } else if(obj) {
        if (obj.status == false){
          Swal.fire({
            text: obj.message,  
            // timer: 2500,
            icon: 'error',
            showConfirmButton: true,
            confirmButtonText: 'Ya',
          });
          // addfield(urutan,trloc);

        } else {
          // addfield(urutan);
          
            $("#designer"+urutan+"").val(desName);
            $("#BtnXApp"+urutan+"").show();
            $("#plusDesbtn"+urutan+"").hide();
            addfield(urutan,trloc);
          
        }
      } else {
        Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
      }
    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });
});



//  PTB LIST PILIH - FUNGSI MEMILIH DATA PTB

$("#tablePTB").on("click", ".selectPTB", function () {

  if(enable_edit){

    var mfgsupp = $(this).attr("mfgsupp");
    var mfgdem = $(this).attr("mfgdem");
    var lot = $(this).attr("lot");
    var brgdem = $(this).attr("brgdem");

    $("#MFGsupp_in").val(mfgsupp);
    $("#MFGdem_in").val(mfgdem);
    $("#lotinv_in").val(lot);
    $("#barangdem_in").val(brgdem);
    $("#reff_in").val(mfgsupp);

    jenis_type='REAL';

  }
  // var mfgsupp = $(this).attr("mfgsupp");
  // var trloc= $(this).closest('tr');
  // var urutan = $("#Iddes").val();

  // $('.windowdesigner').modal('hide');

  
});


// DESIGNER - MENAMBAHKAN FIELD DESIGNER SETELAH MENGISI
// FIELD DESIGNER SEBELUMNYA
function addfield(urutanval){
  console.log(urutanval);
  var urutan=parseInt(urutanval);
  var wrapper =$("#designerdiv");
  if($('#para1').length){
    //element with id exists
  }
  console.log($('#data'+(urutan+1)+'').length);
  if(urutan==1&&$('#data'+(urutan+1)+'').length==0){
    console.log("urutan1");
    $('#data1').after(`<tr id="data`+(urutan+1)+`">
    <td class="RegNew" align="left">Designer `+(urutan+1)+`</td>
    <td class="RegNew" align="left">
      <div class="ui left input fluid small">
        <input type="text" id="designer`+(urutan+1)+`" class="" disabled >
        &nbsp;<button id="plusDesbtn`+(urutan+1)+`" urutan="`+(urutan+1)+`" class="ui blue icon button plusbtn"><i class="plus small icon"></i>
        </button>
        <button id="BtnXApp`+(urutan+1)+`" urutan="`+(urutan+1)+`" class="ui icon button right aligned deldesigner"><i class=" brown x small icon"></i></button>
      </div>
    </td>
  </tr>`);
  $("#BtnXApp"+(urutan+1)+"").hide();
  $("#plusDesbtn"+(urutan+1)+"").show();

  // $('.plusbtn').on('click', function() {

  //   var urutan = $(this).attr('urutan');
  //   $('.windowdesigner').modal('show');
  //   $("#Iddes").val(urutan);
  //   $("#filtercari").val('');
  //   tablelistfunc('');
  // });

  

  }else if(urutan>1&&urutan<10&&$('#data'+(urutan+1)+'').length==0){
    console.log("masukk");
    $('#data'+urutan+'').after(`<tr id="data`+(urutan+1)+`">
    <td class="RegNew" align="left">Designer `+(urutan+1)+`</td>
    <td class="RegNew" align="left">
      <div class="ui left input fluid small">
        <input type="text" id="designer`+(urutan+1)+`" class="" disabled >
        &nbsp;<button id="plusDesbtn`+(urutan+1)+`" urutan="`+(urutan+1)+`" class="ui blue icon button plusbtn"><i class="plus small icon"></i>
        </button>
        <button id="BtnXApp`+(urutan+1)+`" urutan="`+(urutan+1)+`" class="ui icon button right aligned deldesigner"><i class=" brown x small icon"></i></button>
      </div>
    </td>
  </tr>`);
  $("#BtnXApp"+(urutan+1)+"").hide();
  $("#plusDesbtn"+(urutan+1)+"").show();

  // $('.plusbtn').on('click', function() {

  //   var urutan = $(this).attr('urutan');
  //   $('.windowdesigner').modal('show');
  //   $("#Iddes").val(urutan);
  //   $("#filtercari").val('');
  //   tablelistfunc('');
  // });


  // $("#BtnXApp"+(urutan+1)+", #BtnXApp1").on('click', function() {
  //   var Idx     = $(this).attr("urutan");
  //   var vusrnm  = getCookie('usrnm');
  //   var vtoken  = getCookie('token');
    
  //   var desName = $("#designer"+Idx+"").val();
    
  
  //   $.ajax({
  //        type    : "POST",
  //        url     : `${restlocdocmgmt}delete_designer_satuan`,
  //        headers : {
  //          user  : vusrnm,
  //          token : vtoken
  //        },
  //        data: {
  //          nama  : desName,
  //          urutan: Idx,
  //        },
  //        cache: false,
  //        success: function (response){
  //          var obj = JSON.parse(response);
  //          // console.log(obj);
  //          if(isEmpty(obj)) {
  //            console.log('Gagal Hapus mas brooo, data kosong');
  //          } else if(obj) {
  //            if (obj.status == false){
  //              Swal.fire({
  //                text: obj.message,  
  //                timer: 1500,
  //                icon: 'warning',
  //                showConfirmButton: false
  //              });
  
  //            } else {
  
  //             //  if(Idx=="1"){
  //                $("#designer"+Idx+"").val('');
  //                $("#BtnXApp"+Idx+"").hide();
  //                $("#plusDesbtn"+Idx+"").show();
              
          
  //           }
  //          } else {
  //            Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
  //          }
  //        },
  //        error: function () {
  //          if (LogoutProtect){
  //            window.location.href = "./?link=loclogout";
  //          } else {
  //            Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
  //          }
  //        },
  //      });
  //  })

}
}



$(document).on('click',"#typesave",function(){
  tablelistPTB2("");
  simpantemptype();
  
})

$(document).on('click',"#typeedit",function(){
  tablelistPTB2("");
  edittemptype();
  
})



function datepick(){
  $('#tanggaltgs').calendar({
          type: 'date',
          monthFirst: false,
          // minDate : d,
  
          onChange: function(date){
              maxdateset= date;
              // tanggalcek();
              // console.log(maxdateset+"<--ini max date");
              // cekdate(date);
              
              
          },
      formatter: {
      date: function (date, settings) {
          if (!date) return "";
          var day = date.getDate() + "";
          if (day.length < 2) {
          day = "0" + day;
          }
          var month = date.getMonth() + 1 + "";
          if (month.length < 2) {
          month = "0" + month;
          }
          var year = date.getFullYear();
          return day + "-" + month + "-" + year;
          // return year + "-" + month + "-" + day;
      }
  }
      });
      $('#tanggaltgs2').calendar({
        type: 'date',
        monthFirst: false,
        // minDate : d,

        onChange: function(date){
            maxdateset= date;
            // tanggalcek();
            // console.log(maxdateset+"<--ini max date");
            // cekdate(date);
            
            
        },
    formatter: {
    date: function (date, settings) {
        if (!date) return "";
        var day = date.getDate() + "";
        if (day.length < 2) {
        day = "0" + day;
        }
        var month = date.getMonth() + 1 + "";
        if (month.length < 2) {
        month = "0" + month;
        }
        var year = date.getFullYear();
        return day + "-" + month + "-" + year;
        // return year + "-" + month + "-" + day;
    }
}
    });
  
      
  }


  $("#typeTable").on('click', '.deletepenerima', function () {
    $(this).closest('tr').remove();
});


// --------------------- KUMPULAN AJAX -------------------
// --------------- KUMPULAN AJAX 1. SIMPAN TEMP TYPE

function simpantemptype(){
  $(document).ready(function () {
  var mfgsupp=$("#MFGsupp_in").val();
  var lotinv=$("#lotinv_in").val();
  var reffval=$("#reff_in").val();
  var mfgdem = $("#MFGdem_in").val();
  var brgdem = $("#barangdem_in").val();
  var massplan = $("#massplan").val();
  var massactual = $("#massactual").val();
  var costplan = $("#costplan").val();
  var costactual = $("#costactual").val();
  var catatan = $("#catatan_type").val();
  if(mfgsupp != ""){
      $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}create_infotype`,

        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data:{
            typemfgsupply: mfgsupp,
            lotinventory: lotinv,
            typeref : reffval,
            typemfgdemand : mfgdem,
            massproplan : massplan,
            typebarangdemand : brgdem,
            massproactual : massactual,
            costactual : costactual,
            jenis_type : jenis_type,
            costplan : costplan,
            user   : userName1,
            keterangan:catatan,
        },
            success: function (response){
        var obj = JSON.parse(response);
        console.log(obj);
        if(isEmpty(obj)) {
        console.log('Gagal save, data kosong');
        
        
        } else if(obj.status==true) {

          Swal.fire({
            title: 'Berhasil menyimpan type',
            text: "",
            timer: 3000,
            icon: 'success',
            showCancelButton: false,
            showConfirmButton:false,
            });

            tableType("simpan type");

            // CLEAR INPUT SETELAH BERHASIL MELAKUKAN ADD DATA TYPE

            $("#MFGsupp_in").val("");
            $("#lotinv_in").val("");
            $("#reff_in").val("");
            $("#MFGdem_in").val("");
            $("#barangdem_in").val("");
            $("#massplan").val("");
            $("#massactual").val("");
            $("#costplan").val("");
            $("#costactual").val("");
            $("#HeaderPrjID").val("");
            $("#TargetMass_in").val("");
            $("#owner_in").val("");
            $("#catatan_type").val("");

            jenis_type="PLACEHOLDER";
            disable_editmfg(false);
        
        } else if(obj.status==false){
        
          Swal.fire({
            title: obj.message,
            text: "",
            icon: 'error',
            showCancelButton: false,
            confirmButtonText: 'Ya',
            });

            write_msproject();
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    }
    });

  }else{

    Swal.fire({
      title: '<h2>type MFG supply tidak boleh kosong</h2>',
      text: "",
      icon: 'error',
      showCancelButton: false,
      confirmButtonText: 'Ya'
      })
  }
        
  
  
      
      
  });
  
}


// --------------------- KUMPULAN AJAX -------------------
// --------------- KUMPULAN AJAX 1. SIMPAN TEMP TYPE

function edittemptype(){

  enable_action();
  
  $(document).ready(function () {
  var mfgsupp=$("#MFGsupp_in").val();
  var lotinv=$("#lotinv_in").val();
  var reffval=$("#reff_in").val();
  var mfgdem = $("#MFGdem_in").val();
  var brgdem = $("#barangdem_in").val();
  var massplan = $("#massplan").val();
  var massactual = $("#massactual").val();
  var costplan = $("#costplan").val();
  var costactual = $("#costactual").val();
  var idmfgtemp = $("#idtype_edit").val();
  var catatan = $("#catatan_type").val();
  if(mfgsupp != ""){
      $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}update_multitype`,

        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data:{
            typemfgsupply: mfgsupp,
            lotinventory: lotinv,
            typeref : reffval,
            typemfgdemand : mfgdem,
            massproplan : massplan,
            typebarangdemand : brgdem,
            massproactual : massactual,
            costactual : costactual,
            jenis_type : jenis_type,
            costplan : costplan,
            user   : userName1,
            keterangan: catatan,
            idinfotype:idmfgtemp,
        },
            success: function (response){
        var obj = JSON.parse(response);
        console.log(obj);
        if(isEmpty(obj)) {
        console.log('Gagal save, data kosong');
        
        
        } else if(obj.status==true) {

          Swal.fire({
            title: 'Berhasil menyimpan type',
            text: "",
            timer: 3000,
            icon: 'success',
            showCancelButton: false,
            showConfirmButton:false,
            });

            tableType("edit type");
            jenis_type="PLACEHOLDER";

            // CLEAR INPUT SETELAH BERHASIL MELAKUKAN ADD DATA TYPE

            $("#MFGsupp_in").val("");
            $("#lotinv_in").val("");
            $("#reff_in").val("");
            $("#MFGdem_in").val("");
            $("#barangdem_in").val("");
            $("#massplan").val("");
            $("#massactual").val("");
            $("#costplan").val("");
            $("#costactual").val("");
            $("#HeaderPrjID").val("");
            $("#TargetMass_in").val("");
            $("#owner_in").val("");
            $("#catatan_type").val("");

            $('.action_type').empty().append(`

              <div class="ui right fluid floated blue labeled icon button allowed" id="typesave">
                <i class="save icon"></i> <span id="d">simpan info type</span>
              </div>
            
            `)

            $('.edit_back_type').empty();

            if(fungsiedit){
              $('#HeaderButtonEdit').removeClass('disabled').addClass('allowed');

            }else{

              $('#HeaderButtonSave').removeClass('disabled').addClass('allowed');
            }

            disable_editmfg(false);
        
        } else if(obj.status==false){
        
          Swal.fire({
            title: obj.message,
            text: "",
            icon: 'error',
            showCancelButton: false,
            confirmButtonText: 'Ya',
            });
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    }
    });

  }else{

    Swal.fire({
      title: '<h2>type MFG supply tidak boleh kosong</h2>',
      text: "",
      icon: 'error',
      showCancelButton: false,
      confirmButtonText: 'Ya'
      })
  }
        
  
  
      
      
  });
  
}




// --------------------- KUMPULAN AJAX -------------------
// --------------- KUMPULAN AJAX 1. UPDATE TEMP TYPE

function updatetemptype(){
  $(document).ready(function () {
  var mfgsupp=$("#MFGsupp_in").val();
  var lotinv=$("#lotinv_in").val();
  var reffval=$("#reff_in").val();
  var mfgdem = $("#MFGdem_in").val();
  var brgdem = $("#barangdem_in").val();
  var massplan = $("#massplan").val();
  var massactual = $("#massactual").val();
  var costplan = $("#costplan").val();
  var costactual = $("#costactual").val();
  
  if(mfgsupp != ""){
      $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}update_infotype`,

        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data:{
            typemfgsupply: mfgsupp,
            lotinventory: lotinv,
            typeref : reffval,
            typemfgdemand : mfgdem,
            massproplan : massplan,
            typebarangdemand : brgdem,
            massproactual : massactual,
            costactual : costactual,
            jenis_type : jenis_type,
            costplan : costplan,
            user   : userName1,
        },
            success: function (response){
        var obj = JSON.parse(response);
        console.log(obj);
        if(isEmpty(obj)) {
        console.log('Gagal save, data kosong');
        
        
        } else if(obj.status==true) {

          Swal.fire({
            title: 'Berhasil menyimpan type',
            text: "",
            timer: 3000,
            icon: 'success',
            showCancelButton: false,
            showConfirmButton:false,
            });

            tableType("update type");

            // CLEAR INPUT SETELAH BERHASIL MELAKUKAN ADD DATA TYPE

            $("#MFGsupp_in").val("");
            $("#lotinv_in").val("");
            $("#reff_in").val("");
            $("#MFGdem_in").val("");
            $("#barangdem_in").val("");
            $("#massplan").val("");
            $("#massactual").val("");
            $("#costplan").val("");
            $("#costactual").val("");
            $("#HeaderPrjID").val("");
            $("#TargetMass_in").val("");
            $("#owner_in").val("");
            $("#catatan_type").val("");
            
        
        } else if(obj.status==false){

          tableType("gagal update type");
        
          Swal.fire({
            title: obj.message,
            text: "",
            icon: 'error',
            showCancelButton: false,
            confirmButtonText: 'Ya',
            });
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    }
    });

  }else{

    Swal.fire({
      title: '<h2>type MFG supply tidak boleh kosong</h2>',
      text: "",
      icon: 'error',
      showCancelButton: false,
      confirmButtonText: 'Ya'
      })
  }
        
  
  
      
      
  });
  
}


// ------------- KUMPULAN AJAX 2. DELETE DESIGNER SEMUA

function clearDesignerTemp(){

  $.ajax({
    type    : "POST",
    url     : `${restlocdocmgmt}delete_designer`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      // console.log(obj);
      if(isEmpty(obj)) {
        console.log('Gagal Hapus');
      } else if(obj) {
        if (obj.status == false){
          console.log("gagal hapus data 2")

        } else {
          console.log("berhasil")
      
      
      }
      } else {
        console.log('gagal hapus data');
      }
    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });
}

// CLEAR TEMP UNTUK TYPE, MSPROJECT DAN MSPROJECT YANG SUDAH TERHUBUNG DENGAN TYPE

// ------------- KUMPULAN AJAX 2. DELETE DESIGNER SEMUA

function cleartype_temp(){

  $.ajax({
    type    : "POST",
    url     : `${restlocdocmgmt}clear_type`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      // console.log(obj);
      if(isEmpty(obj)) {
        console.log('Gagal Hapus');
        tableType("clear empty");
      } else if(obj) {
        if (obj.status == false){
          console.log("gagal hapus data 2")
          tableType("clear gagal");
        } else {
          console.log("berhasil clear")
          tableType("clear berhasil");
      
      }
      } else {
        tableType("clear gagal else");
        console.log('gagal hapus data');
      }
    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });
}



// -------------- KUMPULAN AJAX 3. KONEKSI PTB

function viewPTB(searchval){
console.log(searchval);
  $.ajax({
    type    : "POST",
    url     : `${restlocdocmgmt}ptb`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      mfgsupply:searchval,
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      // console.log(obj);
      if(isEmpty(obj)) {
       
      } else if(obj) {
        if (obj.status == false){
          console.log("")

        } else {
          console.log("berhasil")
      
      
      }
      } else {
        console.log('gagal hapus data');
      } 
    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });
}



// -------------- KUMPULAN AJAX 3. KONEKSI TABLE PTB

function viewPTBtable(searchval){
  console.log(searchval);
    $.ajax({
      type    : "POST",
      url     : `${restlocdocmgmt}ptb2`,
      headers : {
        user  : vusrnm,
        token : vtoken
      },
      data: {
        mfgsupply:searchval,
      },
      cache: false,
      success: function (response){
        var obj = JSON.parse(response);
        // console.log(obj);
        if(isEmpty(obj)) {
         
        } else if(obj) {
          if (obj.status == false){
            console.log("")
  
          } else {
            console.log("berhasil")
        
        
        }
        } else {
          console.log('gagal hapus data');
        } 
      },
      error: function () {
        if (LogoutProtect){
          window.location.href = "./?link=loclogout";
        } else {
          Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
        }
      },
    });
  }

  // >>>> FUNGSI UNTUK MEMUNCULKAN ATAU MENGHILANGKAN
  //      TOMBOL EDIT DAN DELETE PADA LIST TYPE

  
  function disable_action(){
    allow_clickbtn=false;
    $('.buttons_type').hide();
  }

  function enable_action(){
    allow_clickbtn=true;
    $('.buttons_type').show();
  }
  

// -------------------------------KUMPULAN AJAX 4. TABEL PTB
    // PTB -  TAMPIL TABEL PTB
function tablelistPTB2(searchval){

  // desplace=$("#Iddes").val();

  let $table=$("#tablePTB");
  $("#tablePTB").DataTable({
      dom:
        "<'ui stackable grid'" +
        "<'row'" +
        "<'left aligned sixteen wide column'>" +
        ">" +
        "<'row dt-table'" +
        "<'sixteen wide column'tr>" +
        ">" +
        "<'row'" +
        "<'left aligned eight wide column'>" +
        "<'right aligned eight wide column'>" +
        ">" +
        ">",

        "fnDrawCallback": function() {
          var $dataTable = $table.dataTable();
          $dataTable.fnAdjustColumnSizing(false);
  
          // TableTools
          if (typeof(TableTools) != "undefined") {
              var tableTools = TableTools.fnGetInstance(table);
              if (tableTools != null && tableTools.fnResizeRequired()) {
                  tableTools.fnResizeButtons();
              }
          }
          //
          var $dataTableWrapper = $table.closest(".dataTables_wrapper");
          var panelHeight = $dataTableWrapper.parent().height();
  
          var toolbarHeights = 0;
          $dataTableWrapper.find(".fg-toolbar").each(function(i, obj) {
              toolbarHeights = toolbarHeights + $(obj).height();
          });
  
          var scrollHeadHeight = $dataTableWrapper.find(".dataTables_scrollHead").height();
          var height = panelHeight - toolbarHeights - scrollHeadHeight;
          $dataTableWrapper.find(".dataTables_scrollBody").height(height - 24);
  
          // $dataTable._fnScrollDraw();
      },
    
      destroy: true,
      // stateSave: true,
      // processing: true,
      // deferRender: true,
      // serverSide: true,
      // ordering : false,
      // pageLength: 10,
      data: [],
      language: {
        sLengthMenu: "_MENU_",
        // search: "",
        // searchPlaceholder: "Search..",
        processing: '<i class="circle notch loading icon huge"></i>',
      },
      // "ajax": "./1_documentmanagement/mechanicdesign/ptb.txt",
      "columns": [
        // { "data": "type_mfg_supply" },
        { "data": null,
        render: function (data, type, row) {
          
          if (data[0] != "") {
            // console.log(data[0]);
            return `<span class="edit outline optionselect selectPTB" mfgsupp="${data["type_mfg_supply"]}" mfgdem="${data["type_mfg_demand"]}" lot="${data["lot_inventory"]}" brgdem="${data["type_barang_demand"]}">`+data["type_mfg_supply"]+`</span>`;
          } else {
            return "";
          }
        },
      },
      { "data": null,
        render: function (data, type, row) {
          if (data[0] != "") {
            return `<span class="edit outline optionselect selectPTB" mfgsupp="${data["type_mfg_supply"]}" mfgdem="${data["type_mfg_demand"]}" lot="${data["lot_inventory"]}" brgdem="${data["type_barang_demand"]}">`+data["type_mfg_demand"]+`</span>`;
          } else {
            return "";
          }
        },
      },
      { "data": null,
        render: function (data, type, row) {
          if (data[0] != "") {
            return `<span class="edit outline optionselect selectPTB" mfgsupp="${data["type_mfg_supply"]}" mfgdem="${data["type_mfg_demand"]}" lot="${data["lot_inventory"]}" brgdem="${data["type_barang_demand"]}">`+data["lot_inventory"]+`</span>`;
          } else {
            return "";
          }
        },
      },
      { "data": null,
        render: function (data, type, row) {
          if (data[0] != "") {
            return `<span class="edit outline optionselect selectPTB" mfgsupp="${data["type_mfg_supply"]}" mfgdem="${data["type_mfg_demand"]}" lot="${data["lot_inventory"]}" brgdem="${data["type_barang_demand"]}">`+data["type_barang_demand"]+`</span>`;
          } else {
            return "";
          }
        },
      },
        // { "data": "type_mfg_demand" },
        // { "data": "lot_inventory" },
        // { "data": "type_barang_demand" },


       
        // { "data": "chassis" },
        // { "data": "salary" }
        
      ],

      "fnDrawCallback": function( settings ) {
        // console.log(settings.fnRecordsTotal(),settings._iDisplayLength)
        let api = this.api();
        let rows_amount=api.rows( {page:'current'} ).count();
        let preset_numrows=10;
        let setting_numrows=settings._iDisplayLength;
        let emptyrow=setting_numrows-rows_amount;

        if(rows_amount < setting_numrows && emptyrow>0){
          
          if(rows_amount==0){
            for(let y=1;y<emptyrow;y++){

              // Node.appendChild();
              $('#tablePTB tbody').append($("<tr><td>&nbsp;</td><td></td><td></td><td></td></tr>"));
            }
          }else{
            for(let y=0;y<emptyrow;y++){

              // Node.appendChild();
              $('#tablePTB tbody').append($("<tr><td>&nbsp;</td><td></td><td></td><td></td></tr>"));
            }
          }

          

        }

        // console.log(api.rows( {page:'current'} ).count());
        // console.log(settings);
        // alert( 'DataTables has redrawn the table' );
      },

      

      ajax: {
        url: `${restlocdocmgmt}ptb2`,
        type: "POST",
        headers : {
          user  : vusrnm,
          token : vtoken
        },
        data: {
          mfgsupply:searchval,
        },
        error: function () {
          if (fungsilogout){
            window.location.href = "./?link=loclogout";
          } else {
            Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
          }
        },
      },
    });
    var table2 = $('#tablePTB').DataTable();




    
// $('#MFGsupp_in').keyup( function() {
// // var ptbsearch
// // $("#MFGsupp_in").val('');
// $("#MFGdem_in").val('');
// $("#lotinv_in").val('');
// $("#barangdem_in").val('');
// $("#reff_in").val('');
// console.log(this.value);
// // table.search(""+$('#searchPTB').val()+"").draw();
// table2.search( this.value ).draw();
// // tablePTB.search($('#searchPTB').val()).draw();
// } );

  // $("#designerList").css('cursor', 'pointer');
}

$('#MFGsupp_in').keyup( function() {
  // var ptbsearch
  let mfgval=$(this).val();
  // $("#MFGsupp_in").val('');
  $("#MFGdem_in").val('placeholder');
  $("#lotinv_in").val('placeholder');
  $("#barangdem_in").val('placeholder');
  $("#reff_in").val(mfgval);
  jenis_type="PLACEHOLDER";
  tablelistPTB2(this.value);
  
} );

$('#searchPTB1').keyup( function(event) {
  console.log(this.value);
  if (event.keyCode == 13) {
    tablelistPTB2(this.value);
  }
  
// var ptbsearch

// table.search(""+$('#searchPTB').val()+"").draw();
// table2.search( this.value ).draw();
// tablePTB.search($('#searchPTB').val()).draw();
} );

$('#cariptb').on('click',function(){
  let valsearch=$('#searchPTB1').val();
  tablelistPTB2(valsearch);
})


// ------------- KUMPULAN AJAX 5. TAMPIL DATA TYPE

function tableType(lokasi){
  console.log("dari: "+lokasi);
  $('#typeTable').find('tbody').empty();
  $.ajax({
    type    : "POST",
    url     : `${restlocdocmgmt}table_viewinfotype`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      username   : userName1,
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      // console.log(obj);
      if(isEmpty(obj)) {
        console.log('Gagal Hapus');
      } else{
        if (obj.recordsTotal == 0){
          console.log("data kosong")

          $('#typeTable').find('tbody').append(
            `<tr>
              <td colspan='10' style='text-align:center'>
              belum ada data type
              </td>
              
            </tr>`);

        } else {
          

          console.log("berhasil")
          for(var y=0;y<obj.recordsTotal;y++){
            console.log(y+"<-- banyak draw");
            let masplan= obj.data[y][3]==null ? "-" : (obj.data[y][3]=="" ? "-" : obj.data[y][3]);
            let masact= obj.data[y][7]==null ? "-" : (obj.data[y][7]=="" ? "-" : obj.data[y][7]);
            let costplan= obj.data[y][4]==null ? "-" : (obj.data[y][4]=="" ? "-" : obj.data[y][4]);
            let costact= obj.data[y][8]==null ? "-" : (obj.data[y][8]=="" ? "-" : obj.data[y][8]);
            let ket= obj.data[y][11]==null ? "-" : (obj.data[y][11]=="" ? "-" : obj.data[y][11]);

            let string_action=``

            if(!inArray(obj.data[y][13],obj.adadata)){
                string_action=`<span class='buttons_type'>
                <i class='edit edittype iconcoloredit icon' editid='`+obj.data[y][0]+`' supval='`+obj.data[y][9]+`'></i>
                <i class='trash deletetype iconcoloredit icon' delid='`+obj.data[y][0]+`' supval='`+obj.data[y][9]+`'></i>
                </span>`;

            }else{

                string_action=`
                <span class='buttons_type'>
                <i class='edit edittype iconcoloredit icon' editid='`+obj.data[y][0]+`' supval='`+obj.data[y][9]+`'></i>
                
                </span>
                `
            }

            $('#typeTable').find('tbody').append(
              `<tr class='centerall'>
                <td>
                `+obj.data[y][9]+`
                </td>
                <td>
                `+obj.data[y][5]+`
                </td>
                <td>
                `+obj.data[y][1]+`
                </td>
                <td>
                `+obj.data[y][6]+`
                </td>
                <td>
                `+obj.data[y][2]+`
                </td>
                <td>
                `+masplan+`
                </td>
                <td>
                `+masact+`
                </td>
                <td>
                `+costplan+`
                </td>
                <td>
                `+costact+`
                </td>
                <td stype='vertical-align:center;'>
                
                <i class="sticky iconcoloredit keterangantype note outline icon" data-content="`+ket+`" ></i>
                </td>
                </td>
                <td class='except'>
                `+string_action+`
                </td>
              </tr>`);
          }

          $('.keterangantype')
                .popup({
                  on:'click',
                  hoverable:true,
                  position   : 'bottom left',

                })
              ;

          // <i class='edit edittype iconcoloredit icon' editid='`+obj.data[y][0]+`' supval='`+obj.data[y][9]+`'></i>

          
          // $('#typeTable').find('tbody').append(`
          //     <tr>
          //       <td colspan='10' valign='center'>
          //         <button class="ui labeled blue icon button">
          //           <i class="plus icon"></i>
          //           Tambah Type
          //         </button>
          //       </td>
          //     </tr>
          // `);
          // $('#TableMsProject').find('tbody').append(
          //   "<tr id='"+"test"+"'><td width='80px'>"+"RDCBU14"+
          //   "</td><td class='center' width='400px'>"+"OEM GAS STOVE CIPTA.T 2 TUNGKU TOP METAL"+
          //   "</td><td class='center' width='150px'>"+"USERPRO RND HOME APPLIANCES PL 1"+
          //   "</td><td class='center'><i class='trash actdeleteprjid iconcoloredit icon' id='"+"test"+"'></i></td></tr>");

          $('.deletetype').on('click',function(e){

            if(allow_clickbtn){

              var iddel= $(this).attr('delid');
              var supval = $(this).attr('supval');
              // var dnik= $(this).attr('delnik');
              Swal.fire({
                  title: '<h2>Hapus data ini?</h2>',
                  text: "<span>PERINGATAN: </span>data yang bersangkutan dengan tipe ini juga akan hilang. DATA: "+supval,
                  icon: 'warning',
                  html:"<span>PERINGATAN: </span>data yang bersangkutan dengan tipe ini juga akan hilang. DATA: "+supval,
                  showCancelButton: true,
                  confirmButtonText: 'Ya'
                  }).then((result) => {
                  if (result.value) {
                      //REST CALON DNPENYUSUN
                      $.ajax({
                      type: "POST",
                      url: `${restlocdocmgmt}delete_infotype2`,
                      headers: {
                          user: vusrnm,
                          token: vtoken,
                      },
                      data: {
                          idinfotype : iddel,
                          user : userName1,
                      },
                      cache: false,
                      success: function (response){
                          var obj = JSON.parse(response);
                          if (obj.code == 'error9'){
                          Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
                          } else if (obj.code == 'error10'){
                          Swal.fire('Error','Item yang dimaksud tidak ada !','error')
                          }  else {
                            tableType("delete type");
                          }
                      },
                      error: function(){
                          if(fungsilogout){
          
                              window.location.href="./_logout.php";
                          }else{
                              console.log("error session")
                          }
                      },
                      });
                  }
                  })

            }
            
        
        
        });
      
      }
      }
    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });
}

  // -------------- KUMPULAN AJAX 3. DELETE SEMUA TEMP TYPE

function deletetemptype(){
  // console.log(searchval);
  $.ajax({
    type: "POST",
    url: `${restlocdocmgmt}delete_infotype`,
    headers: {
        user: vusrnm,
        token: vtoken,
    },
    data: {
        
        user : userName1,
    },
    cache: false,
    success: function (response){
        var obj = JSON.parse(response);
        if (obj.code == 'error9'){
        // Swal.fire('Error','Ada kendal di koneksi/database, data tidak tersimpan !','error')
        console.log("err9")
        } else if (obj.code == 'error10'){
        // Swal.fire('Error','Item yang dimaksud tidak ada !','error')
        console.log("err10")
        }  else {
          tableType("deletetemptype");
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    },
    });
  }



  // --------------------- KUMPULAN AJAX -------------------
// --------------- KUMPULAN AJAX 6. SIMPAN HEADER

function simpanheader(){
  var groupprod=$('#groupProd_in').dropdown('get text');
  var subprod =$('#subProd_in').dropdown('get text');
  console.log(subprod);
  var kategorival =$('#Category_in').dropdown('get value');
  var plantval =$('#Plant_in').dropdown('get value');
  var chasisval =$('#chassis_in').dropdown('get value');
  var cabval =$('#cab_in').dropdown('get value');
  var headof = $('#sectionHead_in').dropdown('get value');
  var statusval = $('#status_in').dropdown('get value');
  
  $(document).ready(function () {

  
      $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}create_header`,

        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data:{
            groupproduct : groupprod,
            category: kategorival,
            subproduct : subprod,
            plant : plantval,
            chassis : chasisval,
            cabinet : cabval,
            headof : headof,
            statusproject : statusval,
            user   : userName1,
        },
            success: function (response){
        var obj = JSON.parse(response);
        console.log(obj);
        if(isEmpty(obj)) {
        console.log('Gagal save, data kosong');
        
        
        } else if(obj.status==true) {
        // tableType();

        Swal.fire({
          title: 'Berhasil menyimpan header project_',
          text: "",
          // timer: 3000,
          icon: 'success',
          allowOutsideClick:false,
          showCancelButton: false,
          confirmButtonText:"ya",
          }).then((result) => {
            if (result.value) {
                //KEMBALI HALAMAN PROJECT
                window.location.href = "./?link=mechdocmanagement";
            }
            })
        
        } else if(obj.status==false) {
        // Swal.fire('Error','','error')
        Swal.fire({
          title: obj.message,
          text: "",
          icon: 'error',
          showCancelButton: false,
          confirmButtonText: 'Ya',
          })
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    }
    });
  
        
  
  
      
      
  });
  
}
  

// -------------------- KUMPULAN AJAX ----------
// --------- KUMPULAN AJAX 7. VIEW DATA UNTUK DIEDIT -------

function viewupdatefunc(idproject){

  // decrypt ID project
  let encryption = new Encryption();
  var idDEC = encryption.decrypt(idproject, NonceValue);
  console.log(idDEC);
  $(document).ready(function () {

  
      $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}table_editheader`,

        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data:{
            id_register : idDEC,
            user   : userName1,
        },
            success: function (response){
        var obj = JSON.parse(response);
        console.log(obj);
        if(isEmpty(obj)) {
        console.log('Response kosong');
        
        
        } else if(obj.status==false) {
        // tableType();

        Swal.fire({
          title: obj.message,
          text: "",
          icon: 'error',
          showCancelButton: false,
          confirmButtonText: 'Ya',
          })
        
        } else  {
        // berhasil mendapatkan data, mengisi field dari data yang didapat

        
        
        $('#groupProd_in').dropdown('set selected', obj[0]['group_product'])
        if($('#groupProd_in').dropdown('get value')!=""){
          // FUNGSI AJAX MENGISI DROPDOWN SUB PRODUCT
          isidropsub(obj[0]['group_product'],obj[0]['sub_product'])
          // $('#subProd_in').dropdown('set selected', obj[0]['sub_product']);
          // console.log("testest")
        }

        $('#Category_in').dropdown('set selected', obj[0]['category']);
        $('#Plant_in').dropdown('set selected', obj[0]['plant']);
        $('#chassis_in').dropdown('set selected', obj[0]['chassis']);
        $('#cab_in').dropdown('set selected', obj[0]['cabinet']);
        $('#sectionHead_in').dropdown('set selected', obj[0]['head_of']);
        $('#status_in').dropdown('set selected', obj[0]['status_project']);
        $('#request_in').val(obj[0]['username']);
        viewdesigner();
        tableType("viewdataedit");
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    }
    });

  });
  
}


// -------------------- KUMPULAN AJAX ----------
// --------- KUMPULAN AJAX 8. MENAMPILKAN DESIGNER -------

function viewdesigner(){

  $(document).ready(function () {

  
      $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}table_viewdesigner`,

        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data:{
            
            user   : userName1,
        },
            success: function (response){
        var obj = JSON.parse(response);
        
        if(isEmpty(obj)) {
        console.log('Response kosong');
        
        
        } else if(obj.status==false) {
        // tableType();

        Swal.fire({
          title: obj.message,
          text: "",
          icon: 'error',
          showCancelButton: false,
          confirmButtonText: 'Ya',
          })
        
        } else  {
        
          // MENGISI FIELD DESIGNER UNTUK KEPERLUAN EDIT
          console.log(obj.length);
          var banyakdesigner = obj.length;
          for(var y=1;y<=banyakdesigner;y++){

            if(y==1){
              $("#designer"+y+"").val(obj[y-1]['nama']);
              $("#BtnXApp"+y+"").show();
              $("#plusDesbtn"+y+"").hide();

            }else{

              $('#data'+(y-1)+'').after(`<tr id="data`+y+`">
                <td class="RegNew" align="left">Designer `+y+`</td>
                <td class="RegNew" align="left">
                  <div class="ui left input fluid small">
                    <input type="text" id="designer`+y+`" class="" disabled value="`+obj[y-1]['nama']+`" >
                    &nbsp;<button id="plusDesbtn`+y+`" urutan="`+y+`" class="ui blue icon button plusbtn"><i class="plus small icon"></i>
                    </button>
                    <button id="BtnXApp`+y+`" urutan="`+y+`" class="ui icon button right aligned deldesigner"><i class=" brown x small icon"></i></button>
                  </div>
                </td>
              </tr>`);
              $("#BtnXApp"+y+"").show();
              $("#plusDesbtn"+y+"").hide();

            }
          };

          $('#data'+banyakdesigner+'').after(`<tr id="data`+(banyakdesigner+1)+`">
            <td class="RegNew" align="left">Designer `+(banyakdesigner+1)+`</td>
            <td class="RegNew" align="left">
              <div class="ui left input fluid small">
                <input type="text" id="designer`+(banyakdesigner+1)+`" class="" disabled >
                &nbsp;<button id="plusDesbtn`+(banyakdesigner+1)+`" urutan="`+(banyakdesigner+1)+`" class="ui blue icon button plusbtn"><i class="plus small icon"></i>
                </button>
                <button id="BtnXApp`+(banyakdesigner+1)+`" urutan="`+(banyakdesigner+1)+`" class="ui icon button right aligned"><i class=" brown x small icon deldesigner"></i></button>
              </div>
            </td>
          </tr>`);

          $("#BtnXApp"+(banyakdesigner+1)+"").hide();
            $("#plusDesbtn"+(banyakdesigner+1)+"").show();

        
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    }
    });

  });
  
}


 // --------------------- KUMPULAN AJAX -------------------
// --------------- KUMPULAN AJAX 9. SIMPAN EDIT HEADER

function editheader(){
  let encryption = new Encryption();
  var idDEC = encryption.decrypt(idproject, NonceValue);
  console.log(idDEC);
  
  var groupprod=$('#groupProd_in').dropdown('get text');
  var subprod =$('#subProd_in').dropdown('get value');
  console.log(subprod);
  var kategorival =$('#Category_in').dropdown('get value');
  var plantval =$('#Plant_in').dropdown('get value');
  var chasisval =$('#chassis_in').dropdown('get value');
  var cabval =$('#cab_in').dropdown('get value');
  var headof = $('#sectionHead_in').dropdown('get value');
  var statusval = $('#status_in').dropdown('get value');
  
  $(document).ready(function () {

  
      $.ajax({
        type: "POST",
        url: `${restlocdocmgmt}update_header_`,

        headers: {
            user: vusrnm,
            token: vtoken,
        },
        data:{
            idregister: idDEC,
            groupproduct : groupprod,
            category: kategorival,
            subproduct : subprod,
            plant : plantval,
            chassis : chasisval,
            cabinet : cabval,
            headof : headof,
            statusproject : statusval,
            user   : userName1,
        },
            success: function (response){
        var obj = JSON.parse(response);
        console.log(obj);
        if(isEmpty(obj)) {
        console.log('Gagal save, data kosong');
        
        
        } else if(obj.status==true) {
        // tableType();

        Swal.fire({
          title: 'Berhasil melakukan update header project',
          text: "",
          // timer: 3000,
          icon: 'success',
          allowOutsideClick:false,
          showCancelButton: false,
          confirmButtonText:"ya",
          }).then((result) => {
            if (result.value) {
                //KEMBALI HALAMAN PROJECT
                window.location.href = "./?link=mechdocmanagement";
            }
            })
        
        } else if(obj.status==false) {
        // Swal.fire('Error','','error')
        Swal.fire({
          title: obj.message,
          text: "",
          icon: 'error',
          showCancelButton: false,
          confirmButtonText: 'Ya',
          })
        }
    },
    error: function(){
        if(fungsilogout){

            window.location.href="./_logout.php";
        }else{
            console.log("error session")
        }
    }
    });
  
        
  
  
      
      
  });
  
}
  


 // --------------------- KUMPULAN AJAX -------------------
// -----KUMPULAN AJAX: FUNGSI UNTUK MENGISIA DROPDOWN SUB PRODUCT BERDASARKAN KODE GROUP PRODUCT

function isidropsub(valgroup,editsub){
  console.log("test->"+valgroup);
  console.log(editsub);
    if(editsub!==false){
      // dalam mode edit
      valgroup=$('#groupProd_in').dropdown('get value');

    }
    console.log("test2->"+valgroup);
      $(document).ready(function () {

    
        $.ajax({
          type: "POST",
          url: `${restlocdocmgmt}table_viewsubproduk`,

          headers: {
              user: vusrnm,
              token: vtoken,
          },
          data:{
              kode:valgroup,
          },
              success: function (response){
          var obj = JSON.parse(response);
          console.log(obj);
          if(isEmpty(obj)) {
          console.log('Gagal tampil, data kosong');
          
          
          } else if(obj.status==false) {
          // tableType();

          // SETTING INPUT PRODUCT
            // ---- GROUP PRODUCT OPTION
            $("body").on('change', '#groupProd_in', function(){
              var groupval=$("#groupProd_in").val();
              console.log(groupval);

              isidropsub(groupval,false);

                $('.ui.dropdown.subprod').removeClass("disabled disabledin");
                $('#subproddiv').removeClass("disabledin");
              
            });
          
          
          } else {
            dropstring="<option value=''>SUB PRODUCT</option>";
            panjangdrop=obj.length;
            for(var c=0;c<panjangdrop;c++){
              if(editsub!==false){
                if(editsub===obj[c]['nama_sub']){

                  dropstring+=`
                  <option value="`+obj[c]['nama_sub']+`" selected>`+obj[c]['nama_sub']+`</option>
                  `

                }else{

                  dropstring+=`
                  <option value="`+obj[c]['nama_sub']+`">`+obj[c]['nama_sub']+`</option>
                  `
                }
                
              }else{
                dropstring+=`
                <option value="`+obj[c]['nama_sub']+`">`+obj[c]['nama_sub']+`</option>
                `

              }
              
            }
            
            // $('#fsub_prod').dropdown('clear');
            // $('#fsub_prod').val('ALL');
            $('#subProd_in').dropdown('clear');
            $('#subproddiv').find('.default.text').text('SUB PRODUCT');
            
            $('#subProd_in').empty()
            .append(dropstring).dropdown().dropdown('set selected',editsub);
            $('.ui.dropdown.subprod').removeClass("disabled disabledin");
            $('#subproddiv').removeClass("disabledin");
            
            // $('.ui.dropdown.fsubdrop').find('.default.text').text('SUB PRODUCT');


            // SETTING INPUT PRODUCT
            // ---- GROUP PRODUCT OPTION
            $("body").on('change', '#groupProd_in', function(){
              var groupval=$("#groupProd_in").val();
              console.log(groupval);

              isidropsub(groupval,false);

                $('.ui.dropdown.subprod').removeClass("disabled disabledin");
                $('#subproddiv').removeClass("disabledin");
              
            });

          }
      },
      error: function(){
          if(fungsilogout){

              window.location.href="./_logout.php";
          }else{
              console.log("error session")
          }
      }
      });
    

        
    });
  

}



 // --------------------- KUMPULAN AJAX -------------------
// -----KUMPULAN AJAX: FUNGSI MENYIMPAN MSPROJECT

function save_msproject(ms_indentifier){

  
  $(document).ready(function () {


    $.ajax({
      type: "POST",
      url: `${restlocdocmgmt}create_msproject`,

      headers: {
          user: vusrnm,
          token: vtoken,
      },
      data:{
          user: userName1,
          projectidentifier:ms_indentifier,
      },
          success: function (response){
      var obj = JSON.parse(response);
      console.log(obj);
      if(isEmpty(obj)) {
      console.log('ERROR: no respond');
      
      
      } else if(obj.status==false) {

        $('#AddHeaderPrjID').dropdown('clear');
      // tableType();
        Swal.fire({
          text: obj.message,  
          // timer: 2500,
          icon: 'error',
          showConfirmButton: true,
          confirmButtonText: 'Ya',
        });
      
      } else {
        $('#AddHeaderPrjID').dropdown('clear');
        view_msproject();
        Swal.fire({
          text: obj.message,  
          toast:true,
          position:'top-right',
          timer: 2500,
          // icon: 'success',
          showConfirmButton: false,
          // confirmButtonText: 'Ya',
        });
      }
  },
  error: function(){
      if(fungsilogout){

          window.location.href="./_logout.php";
      }else{
          console.log("error session")
      }
  }
  });


    
});


}



 // --------------------- KUMPULAN AJAX -------------------
// -----KUMPULAN AJAX: FUNGSI MENYIMPAN MSPROJECT

function view_msproject(){

  $('#TableMsProject').find('tbody').empty();
  $(document).ready(function () {


    $.ajax({
      type: "POST",
      url: `${restlocdocmgmt}table_viewmsproject`,

      headers: {
          user: vusrnm,
          token: vtoken,
      },
      data:{
          user: userName1,
          // projectidentifier:ms_indentifier,
      },
          success: function (response){
      var obj = JSON.parse(response);
      console.log(obj);
      if(isEmpty(obj)) {
      console.log('ERROR: no respond');
      
      
      } else if(obj.status==false) {
      // tableType();
      $('#TableMsProject').find('tbody').append(`
        <tr>

              <td style='text-align:center;'>
               list msproject kosong
              </td>
  
            </tr>
      `);
      
      } else {
        // ADA DATA MSPROJECT YANG DITAMPILKAN
        
          var banyakdata=obj.length;
          var stringrow="";
          for(var x=0;x<banyakdata;x++){
            stringrow+=`
            <tr>

              <td>
               `+obj[x]["ProjectIdentifier"]+`
              </td>
              <td>
              `+obj[x]["Z2ProjectDescription"]+`
              </td>
              <td>
              `+obj[x]["ProjectOwnerName"]+`
              </td>
              <td>
              <i class='trash delmsproject iconcoloredit icon' delid='`+obj[x]["id_tempmsprojectfm"]+`' ></i>
              </td>
              

            </tr>
            `
          }

          $('#TableMsProject').find('tbody').append(stringrow);


      }
  },
  error: function(){
      if(fungsilogout){

          window.location.href="./_logout.php";
      }else{
          console.log("error session")
      }
  }
  });


    
});


}




 // --------------------- KUMPULAN AJAX -------------------
// -----KUMPULAN AJAX: MENGAMBIL DATA YANG ADA DI TEMP MSPROJECT DAN EMMBUAT STRING UTNUK DIISIKAN KE INPUT

function write_msproject(){

  $(document).ready(function () {


    $.ajax({
      type: "POST",
      url: `${restlocdocmgmt}table_viewmsproject`,

      headers: {
          user: vusrnm,
          token: vtoken,
      },
      data:{
          user: userName1,
          // projectidentifier:ms_indentifier,
      },
          success: function (response){
      var obj = JSON.parse(response);
      console.log(obj);
      if(isEmpty(obj)) {
      console.log('ERROR: no respond');
      
      
      } else if(obj.status==false) {
      // tableType();
      $('#HeaderPrjID').val("");
      $('#owner_in').val("");
      $('#TargetMass_in').val("");
      } else {
        // ADA DATA MSPROJECT YANG DITAMPILKAN
        
          let banyakdata=obj.length;
          let projidtxt="";
          let ownertxt="";
          let targettxt="";
            for(var x=0;x<banyakdata;x++){
              // projidtxt+=obj[x]["ProjectIdentifier"]+`, `;
              // ownertxt+=obj[x]["ProjectIdentifier"]+`, `;

              if(obj[x]["ProjectIdentifier"]==null||obj[x]["ProjectIdentifier"]==""){
                projidtxt+=`-, `;

              }else{
                projidtxt+=obj[x]["ProjectIdentifier"]+`, `;
              }

              if(obj[x]["ProjectOwnerName"]==null||obj[x]["ProjectOwnerName"]==""){
                ownertxt+=`-, `;

              }else{
                ownertxt+=obj[x]["ProjectOwnerName"]+`, `;
              }

              if(obj[x]["ProjectBaselineFinishDate"]==null||obj[x]["ProjectBaselineFinishDate"]==""){
                targettxt+=`-, `;

              }else{
                targettxt+=obj[x]["ProjectBaselineFinishDate"]+`, `;
              }
              
            }

            projidtxt = projidtxt.replace(/,\s*$/, "");
            ownertxt = ownertxt.replace(/,\s*$/, "");
            targettxt = targettxt.replace(/,\s*$/, "");

            $('#HeaderPrjID').val(projidtxt);
            $('#owner_in').val(ownertxt);
            $('#TargetMass_in').val(targettxt);
            

          // $('#TableMsProject').find('tbody').append(stringrow);


      }
  },
  error: function(){
      if(fungsilogout){

          window.location.href="./_logout.php";
      }else{
          console.log("error session")
      }
  }
  });


    
});


}