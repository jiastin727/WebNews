$(".ui.dropdown").dropdown();
$(".menu .item").tab();
$('.ui.accordion').accordion(
  {exclusive : false}
);

// Global Variable
const NonceValue = "rdsystem2020";
const LogoutProtect = true;

const ColorOwner  = "#00139f";
const ColorRelease= "#8d8d8d";

var vusrnm = getCookie("usrnm");
var vtoken = getCookie("token");

var restlocpsc = decodeURIComponent(getCookie("restlocpsc"));
let Ucrypt = new Encryption();
var Udecrypt = Ucrypt.decrypt(EncU, NonceValue);
var sign_c  = "";
var sign_e  = "";
var sign_m  = "";
var sign_i  = "";
var date_c  = "";
var date_e  = "";
var date_m  = "";
var date_i  = "";

var sign_hc = "";
var sign_he = "";
var sign_hm = "";
var sign_hi = "";

var name_hc = "";
var name_he = "";
var name_hm = "";
var name_hi = "";

var sign_hog = "";
var sign_pl  = "";
var sign_hod = "";
var sign_release = "";

var date_hc = "";
var date_he = "";
var date_hm = "";
var date_hi = "";

var date_hog = "";
var date_pl  = "";
var date_hod = "";
var date_release = "";

var picc_hod = "";

const PicCy =[];
const PicEl =[];
const PicMd =[];
const PicId =[];

// var PICstatusC   = 0;
// var PICstatusE   = 0;
// var PICstatusM   = 0;
// var PICstatusI   = 0;

//Fungsi Load Sign
function LoadDataSign(){
  $.ajax({
    type    : "POST",
    url     : `${restlocpsc}load_datasign`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      PSCId    : idpsc,
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      jmlData = obj.length;
      for (a = 0; a < jmlData; a++) {


        if(obj[a]['jabatan'] =='ENGINEER' && obj[a]['signed_role'] =='ELECTRONIC HARDWARE' ){
          sign_e  = obj[a]['status_sign'];
          date_e  = obj[a]['signed_date'];
          picc_e  = obj[a]['pic'];
          $('.DesElec').text(picc_e);
        }
        if(obj[a]['jabatan'] =='ENGINEER' && obj[a]['signed_role'] =='CYCLE UNIT' ){
          sign_c  = obj[a]['status_sign'];
          date_c  = obj[a]['signed_date'];
          picc_c  = obj[a]['pic'];
          $('.DesCycle').text(picc_c);

        }
        if(obj[a]['jabatan'] =='ENGINEER' && obj[a]['signed_role'] =='MECHANICAL DESIGN' ){
          sign_m  = obj[a]['status_sign'];
          date_m  = obj[a]['signed_date'];
          picc_m  = obj[a]['pic'];
          $('.DesMech').text(picc_m);
        }
        if(obj[a]['jabatan'] =='ENGINEER' && obj[a]['signed_role'] =='INDUSTRIAL DESIGN' ){
          sign_i  = obj[a]['status_sign'];
          date_i  = obj[a]['signed_date'];
          picc_i  = obj[a]['pic'];
          $('.DesInd').text(picc_i);
        }




        if(obj[a]['jabatan'] =='HEAD OF' && obj[a]['signed_role'] =='HEAD OF ELECTRONIC HARDWARE' ){
          sign_he  = obj[a]['status_sign'];
          date_he  = obj[a]['signed_date'];
          picc_he  = obj[a]['pic'];
          $('.electpic_h').text(obj[a]['pic']);
          
        }
        if(obj[a]['jabatan'] =='HEAD OF' && obj[a]['signed_role'] =='HEAD OF CYCLE UNIT' ){
          sign_hc  = obj[a]['status_sign'];
          date_hc  = obj[a]['signed_date'];
          picc_hc  = obj[a]['pic'];
          $('.cyclepic_h').text(obj[a]['pic']);
        }
        if(obj[a]['jabatan'] =='HEAD OF' && obj[a]['signed_role'] =='HEAD OF MECHANICAL DESIGN' ){
          sign_hm  = obj[a]['status_sign'];
          date_hm  = obj[a]['signed_date'];
          picc_hm  = obj[a]['pic'];
          $('.mdpic_h').text(obj[a]['pic']);
        }
        if(obj[a]['jabatan'] =='HEAD OF' && obj[a]['signed_role'] =='HEAD OF INDUSTRIAL DESIGN' ){
          sign_hi  = obj[a]['status_sign'];
          date_hi  = obj[a]['signed_date'];
          picc_hi  = obj[a]['pic'];
          $('.idpic_h').text(obj[a]['pic']);
        }


        if(obj[a]['signed_role'] =='HEAD OF GROUP PRODUCT' ){
          sign_hog  = obj[a]['status_sign'];
          date_hog  = obj[a]['signed_date'];
        }

        if(obj[a]['signed_role'] =='PROJECT LEADER' ){
          sign_pl  = obj[a]['status_sign'];
          date_pl  = obj[a]['signed_date'];
        }

        if(obj[a]['signed_role'] =='HEAD OF DQA' ){
          sign_hod  = obj[a]['status_sign'];
          date_hod  = obj[a]['signed_date'];
          picc_hod  = obj[a]['pic'];
        }

        if(obj[a]['signed_role'] =='RELEASE' ){
          sign_release  = obj[a]['status_sign'];
          date_release  = obj[a]['signed_date'];
          pic_release   = obj[a]['signed_by'];
        }
        
        $('#pldate').text(date_pl);
        $('#headofgroupdate').text(date_hog);
        // DQA Sign Check
        if(sign_hod =="SIGN"){
          $('#headofdqadate').text(date_hod);
          $('#BtnSignHOD').text('Confirmed');
          $('#BtnSignHOD').addClass('basic green');
          $('#StsSignHOD').val('confirmed');
          $('.PICcheckerlist').removeClass('disabled');
        } else {
          $('#headofdqadate').text('-');
          $('#BtnSignHOD').text('Confirm');
          $('#StsSignHOD').val('CONFIRM');
          $('.PICcheckerlist').addClass('disabled');

        }
        
        
       

      }

      // DQA Release PSC Check
      if(sign_release == "NOT RELEASE"){
        
        $('#headofdqappicrelease').text('');
        $('#BtnSignRelease').text('-');
        $('#BtnSignRelease').addClass('basic grey disabled');
        $('#BtnSignRelease').removeClass('green');
        $('#StsSignRelease').val('released');
        $('.PICcheckerlist').removeClass('disabled');
      
      } else {
        $('#headofdqappicrelease').text(pic_release);
        $('#releasedate').text(date_release);
        $('#BtnSignRelease').text('Released');
        $('#BtnSignRelease').addClass('green basic');
        $('#BtnSignRelease').removeClass('disabled');
        $('#StsSignRelease').val('released');
        $('.PICcheckerlist').addClass('disabled');
      }

    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });
}




//Fungsi Load PIC DQA
function LoadDataPICDQA(section){
  $.ajax({
    type    : "POST",
    url     : `${restlocpsc}table_checker`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      id_psc    : idpsc,
      section  : section,
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      jmlobj = obj.length;
      
      for (a = 0; a < jmlobj; a++) {
        if(obj[a]['section']==='CYCLE'){
          if(obj[a]['role']==='PERFORMANCE'){
            $("#PICDQAPerfC").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicCy.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignPerfC").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignPerfC").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignPerfC").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignPerfC").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MEASUREMENT'){
            $("#PICDQAMeasC").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicCy.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMeasC").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMeasC").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMeasC").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMeasC").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='RELIABILITY'){
            $("#PICDQAReliaC").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicCy.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignReliaC").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignReliaC").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignReliaC").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignReliaC").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='SAFETY'){
            $("#PICDQASafC").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicCy.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignSafC").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignSafC").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignSafC").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignSafC").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MECHANIC'){
            $("#PICDQAMechC").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicCy.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMechC").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMechC").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMechC").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMechC").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='REGULASI'){
            $("#PICDQARegC").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicCy.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignRegC").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignRegC").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignRegC").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignRegC").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          }

        } else if(obj[a]['section']==='ELECTRONIC'){
          
          if(obj[a]['role']==='PERFORMANCE'){
            $("#PICDQAPerfE").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicEl.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignPerfE").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignPerfE").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignPerfE").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignPerfE").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MEASUREMENT'){
            $("#PICDQAMeasE").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicEl.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMeasE").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMeasE").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMeasE").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMeasE").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='RELIABILITY'){
            $("#PICDQAReliaE").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicEl.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignReliaE").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignReliaE").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignReliaE").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignReliaE").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='SAFETY'){
            $("#PICDQASafE").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicEl.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignSafE").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignSafE").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignSafE").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignSafE").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MECHANIC'){
            $("#PICDQAMechE").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicEl.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMechE").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMechE").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMechE").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMechE").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='REGULASI'){
            $("#PICDQARegE").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicEl.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignRegE").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignRegE").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignRegE").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignRegE").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } 

        } else if(obj[a]['section']==='MD'){

          if(obj[a]['role']==='PERFORMANCE'){
            $("#PICDQAPerfM").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicMd.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignPerfM").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignPerfM").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignPerfM").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignPerfM").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MEASUREMENT'){
            $("#PICDQAMeasM").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicMd.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMeasM").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMeasM").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMeasM").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMeasM").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='RELIABILITY'){
            $("#PICDQAReliaM").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicMd.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignReliaM").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignReliaM").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignReliaM").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignReliaM").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='SAFETY'){
            $("#PICDQASafM").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicMd.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignSafM").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignSafM").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignSafM").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignSafM").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MECHANIC'){
            $("#PICDQAMechM").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicMd.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMechM").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMechM").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMechM").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMechM").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='REGULASI'){
            $("#PICDQARegM").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicMd.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignRegM").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignRegM").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignRegM").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignRegM").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } 

        } else if(obj[a]['section']==='ID'){

          if(obj[a]['role']==='PERFORMANCE'){
            $("#PICDQAPerfI").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicId.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignPerfI").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignPerfI").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignPerfI").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignPerfI").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MEASUREMENT'){
            $("#PICDQAMeasI").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicId.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMeasI").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMeasI").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMeasI").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMeasI").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='RELIABILITY'){
            $("#PICDQAReliaI").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicId.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignReliaI").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignReliaI").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignReliaI").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignReliaI").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='SAFETY'){
            $("#PICDQASafI").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicId.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignSafI").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignSafI").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignSafI").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignSafI").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='MECHANIC'){
            $("#PICDQAMechI").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicId.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignMechI").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignMechI").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignMechI").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignMechI").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } else if(obj[a]['role']==='REGULASI'){
            $("#PICDQARegI").text(obj[a]['pic']);
            if(obj[a]['status_sign']==='NOT SIGN'){
              PicId.push(obj[a]['pic']);
              if(obj[a]['pic'] == Udecrypt) {
                $("#SignRegI").html("<a class='ui teal tiny label BtnSignPIC' idchk='"+obj[a]['id_checker']+"' sect='"+section+"' >SIGN</a>");
              } else {
                $("#SignRegI").html("<a class='ui basic grey tiny label' >PROSES</a>");
              }
            } else if(obj[a]['status_sign']==='RETURN'){
              $("#SignRegI").html("<a class='ui basic grey tiny label' >RETURN</a>");
            } else {
              $("#SignRegI").html("<a class='ui basic teal tiny label' >SIGNED</a>");
            }
          } 
        }

      }
      FungsiSignPIC();
      var ArrPicCy = (PicCy.indexOf(Udecrypt) > -1);
      var ArrPicEl = (PicEl.indexOf(Udecrypt) > -1);
      var ArrPicMd = (PicMd.indexOf(Udecrypt) > -1);
      var ArrPicId = (PicId.indexOf(Udecrypt) > -1);
      // console.log(ArrPicCy);
      // console.log(ArrPicMd);
      // console.log(ArrPicMd);
      // console.log(ArrPicId);
      $('.DDCYCLE').prop('disabled', 'disabled');
      $('.DDELECTRONIC').prop('disabled', 'disabled');
      $('.DDMD').prop('disabled', 'disabled');
      $('.DDID').prop('disabled', 'disabled');
      $(".SDDCYCLE").css("pointer-events", "none");
      $(".SDDELECTRONIC").css("pointer-events", "none");
      $(".SDDMD").css("pointer-events", "none");
      $(".SDDID").css("pointer-events", "none");

      if(ArrPicCy){
        $('.DDCYCLE').prop('disabled', false);
        $(".SDDCYCLE").css("pointer-events", "auto");
        // $('.DDCYCLE').removeClass('reddropdown');
      } else {
        $('.DDCYCLE').prop('disabled', 'disabled');
        $(".SDDCYCLE").css("pointer-events", "none");
        // $('.DDCYCLE').addClass('reddropdown');
      }
      if(ArrPicEl){
        $('.DDELECTRONIC').prop('disabled', false);
        $(".SDDELECTRONIC").css("pointer-events", "auto");
        // $('.DDELECTRONIC').removeClass('reddropdown');
      } else {
        $('.DDELECTRONIC').prop('disabled', 'disabled');
        $(".SDDELECTRONIC").css("pointer-events", "none");
        // $('.DDELECTRONIC').addClass('reddropdown');
      }
      if(ArrPicMd){
        $('.DDMD').prop('disabled', false);
        $(".SDDMD").css("pointer-events", "auto");
        // $('.DDMD').removeClass('reddropdown');
      } else {
        $('.DDMD').prop('disabled', 'disabled');
        $(".SDDMD").css("pointer-events", "none");
        // $('.DDMD').addClass('reddropdown');
      }
      if(ArrPicId){
        $('.DDID').prop('disabled', false);
        $(".SDDID").css("pointer-events", "auto");
        // $('.DDID').removeClass('reddropdown');
      } else {
        $('.DDID').prop('disabled', 'disabled');
        $(".SDDID").css("pointer-events", "none");
        // $('.DDID').addClass('reddropdown');
      }


    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });

}

//Load Data Content ------------------------------
function LoadDataContent(section){

  if(section =="CYCLE"){
    var TC = "#TableContentC";
  } else if(section =="ELECTRONIC"){
    var TC = "#TableContentE";
  } else if(section =="MD"){
    var TC = "#TableContentM";
  } else if(section =="ID"){
    var TC = "#TableContentI";
  } 
  $.ajax({
    type    : "POST",
    url     : `${restlocpsc}loadcontentvalue`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      PSCId    : idpsc,
      section  : section,
      produk   : pprd,
      jenisprd : jprd
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      if (isEmpty(obj)) {
        console.log("Gagal load, data kosong");
        return false;
      } else if (obj) {
        $(TC).empty();
        var Finalresult = 0;
        
        
        //List Level 1
        jmlDataa = obj["read_content"].length;
        jmlvalue = obj["read_value"].length;
        var Sts = obj['read_sectionresult']['status'];
        var Msg = obj['read_sectionresult']['message'];

        // console.log('Msg: '+Msg);
        // console.log('Sts: '+Sts);
        
        if(obj['read_sectionprogress'][0]['c_section'] =='CYCLE' ){
          $('#VersiCy').text(obj['read_sectionprogress'][0]['no_progress']);
          var VCY = obj['read_sectionprogress'][0]['no_progress'];
        }
        if(obj['read_sectionprogress'][0]['c_section'] =='ELECTRONIC' ){
          $('#VersiEl').text(obj['read_sectionprogress'][0]['no_progress']);
          var VEL = obj['read_sectionprogress'][0]['no_progress'];
        }
        if(obj['read_sectionprogress'][0]['c_section'] =='MD' ){
          $('#VersiMD').text(obj['read_sectionprogress'][0]['no_progress']);
          var VMD = obj['read_sectionprogress'][0]['no_progress'];
        }
        if(obj['read_sectionprogress'][0]['c_section'] =='ID' ){
          $('#VersiID').text(obj['read_sectionprogress'][0]['no_progress']);
          var VID = obj['read_sectionprogress'][0]['no_progress'];
        }
        

        if(jmlDataa < 2){
          $("#ID"+section).hide();
        } else {
          $("#ID"+section).show();
        }
        for (a = 0; a < jmlDataa; a++) {
          $(TC).append(
          "<div class='active title'>"+
            "<i class='dropdown icon'></i>"+obj["read_content"][a]['c_name']+
          "</div>"+
          "<div class='active content'>"+
            "<table class='ui very basic very compact table "+section+a+"'>"+
              "<tbody>"+
              "</tbody>"+
            "</table>"+
          "</div>"
          );
          

          //List Level 2
          if (typeof obj["read_content"][a]['nodes'] !== "undefined") {
            jmlDatab = obj["read_content"][a]['nodes'].length;
            for (b = 0; b < jmlDatab; b++) {
              var id2 = obj["read_content"][a]['nodes'][b]['c_id'];
              var de2 = obj["read_content"][a]['nodes'][b]['c_name'];
              var at2 = obj["read_content"][a]['nodes'][b]['c_attrib'];
              var in2 = obj["read_content"][a]['nodes'][b]['c_input'];
              var op2 = obj["read_content"][a]['nodes'][b]['c_option'];
              var do2 = obj["read_content"][a]['nodes'][b]['c_docs'];
              var ad2 = do2.split(',');
              var npibp = do2.replace(",", "&nbsp;&nbsp;|&nbsp;&nbsp;");
              var npibp2 = "";
              if(do2){
                var npibp2 = "<div class='ui mini teal basic label TandaiNPI' idxx='"+id2+"' suppdocx='"+do2+"''>"+npibp+"</div>";
              }
              
              //Baca Value dari Json 'read_value' sesuai dengan content_id nya di level 2
              var val2    = "";
              var v_idv2  = "";
              var v_res2  = "";
              for (value_a = 0; value_a < jmlvalue; value_a++) {
                var v_idc2 = obj["read_value"][value_a]['v_idcontent'];
                if(id2 == v_idc2){
                  var val2    = obj["read_value"][value_a]['v_value'].replaceAll(";", ", ");
                  var v_idv2  = obj["read_value"][value_a]['v_id'];
                  var v_res2  = obj["read_value"][value_a]['v_result'];
                  var v_cek2  = obj["read_value"][value_a]['v_checker'];
                  var v_res2a = obj["read_value"][value_a]['v_result'];
                  var v_reason2 = obj["read_value"][value_a]['reason'];
                  var reason2 = "<span class='AddNoteChecker SDD"+section+"' note='' id='"+v_idv2+"'><i class='sticky note outline disabled grey link icon'></i></span>";

                  if (v_reason2){
                  reason2 = "<span class='AddNoteChecker SDD"+section+"' note='"+v_reason2+"' id='"+v_idv2+"' data-tooltip='"+v_reason2+"' data-inverted='' data-variation='basic' data-position='top right'><i class='sticky note teal link icon'></i></span>";
                  }


                  if(!v_res2){
                    v_res2 = "-";
                  }
                  if(((VCY ==="C01") || (VEL ==="E01") || (VMD ==="M01") || (VID ==="I01")) && (v_res2 === "MODIF")){
                    v_res2 = "-";
                  }
                  if(v_res2 ==="MODIF" && v_cek2 === null){
                    v_res2 = "-";
                  }
                  if(v_res2a === "NOT OK" || (v_res2a === "MODIF" && v_cek2) || (val2 && v_res2a !== "OK")){
                    Finalresult++
                  }
                  break;

                } else {
                  var v_cek2  = '';
                }
              }

              //Tampilkan jika data tersebut untuk Suppoert Document NPI/BP
              if(($.inArray('NPI', ad2) > -1) && val2){
                var doc12 = "<div class='ui mini circular label teal'>NPI</div>"; 
              } else {
                var doc12 = "";
              }
              if(($.inArray('BP', ad2) > -1) && val2){
                var doc22 = "<div class='ui mini circular label'>BP</div>"; 
              } else {
                var doc22 = "";
              }

              var sel2 = "SelectLv2"+id2;
              if((at2==="YES")){

                var coloritem = "#fff";
                if(v_res2 === "-"){
                  var coloritem = "#efeffe";
                }
                if(v_res2 === "NOT OK"){
                  var coloritem = "#ffe3e3";
                }
                if(v_res2 === "MODIF"){
                  var coloritem = "#ffffea";
                }


                if(((val2 === '' || val2 === null || typeof val2 === 'undefined') && !v_cek2 )){

                  $('.'+section+a).find("tbody").append(
                    "<tr>"+
                      "<td width='1%' class='right aligned'></td>"+
                      "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub1'>"+de2+"</span></td>"+
                      "<td width='50%' class='left aligned'><i style='color: #ccc;'>empty_value - no need verification</i></td>"+
                      "<td width='7%' class='left aligned'></td>"+
                      "<td width='10%' class='left aligned' ></td>"+
                      "<td width='1%' class='left aligned' ></td>"+
                    "</tr>"
                    );

                } else {

                  if(in2==="IMAGE"){
                    if (val2 ===""){
                      var dataimage2 = "<i style='color: #ccc;'>empty_image</i>";
                    } else {
                      var dataimage2 = "<img width='350' src='../RND_Upload/ProductSpec/"+val2+"'>";
                    }
                    $('.'+section+a).find("tbody").append(
                    "<tr style='background-color: "+coloritem+";'>"+
                      "<td width='1%' class='right aligned'></td>"+
                      "<td width='30%' class='left aligned'><span class='sub1'>"+de2+"</span></td>"+
                      "<td width='50%' class='left aligned'>"+dataimage2+"</td>"+
                      "<td width='7%' class='left aligned'>"+npibp2+"</td>"+
                      "<td width='10%' class='left aligned' >"+
                        // "<select class='selectpsc dropdownubahresult disabled DD"+section+"'  id='"+sel2+"' idv='"+v_idv2+"'>"+
                        //   "<option selected value='-'>-</option>"+
                        //   "<option value='OK'>OK</option>"+
                        //   "<option value='NOT OK'>NOT OK</option>"+
                        //   "<option disabled value='MODIF'>MODIF</option>"+
                        // "</select>"+

                        "<input id='"+sel2+"' idv='"+v_idv2+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+
                        
                      "</td>"+
                      "<td width='1%' class='right aligned'>"+reason2+"</td>"+
                    "</tr>"
                    );
                  } else if(in2==="FILE"){
                    if (val2 ===""){
                      var datafile2 = "Belum upload file yang dimaksud.";
                    } else {
                      var datafile2 = "<a href='../RND_Upload/ProductSpec/"+val2+"' target='_blank'>"+val2+"</a>";
                    }
                    $('.'+section+a).find("tbody").append(
                    "<tr style='background-color: "+coloritem+";'>"+
                      "<td width='1%' class='right aligned'></td>"+
                      "<td width='30%' class='left aligned'><span class='sub1'>"+de2+"</span></td>"+
                      "<td width='50%' class='left aligned'>"+datafile2+"</td>"+
                      "<td width='7%' class='left aligned'>"+npibp2+"</td>"+
                      "<td width='10%' class='left aligned' >"+
                        // "<select class='selectpsc dropdownubahresult disabled DD"+section+"'  id='"+sel2+"' idv='"+v_idv2+"'>"+
                        //   "<option selected value='-'>-</option>"+
                        //   "<option value='OK'>OK</option>"+
                        //   "<option value='NOT OK'>NOT OK</option>"+
                        //   "<option disabled value='MODIF'>MODIF</option>"+
                        // "</select>"+

                        "<input id='"+sel2+"' idv='"+v_idv2+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                      "</td>"+
                      "<td width='1%' class='right aligned'>"+reason2+"</td>"+
                    "</tr>"
                    );
                  } else {
                    if (val2 ==="" ){
                      var dataval2 = "<i style='color: #ccc;'>set to empty value</i>";
                    } else {
                      var dataval2 = val2;
                    }
                    $('.'+section+a).find("tbody").append(
                    "<tr style='background-color: "+coloritem+";'>"+
                      "<td width='1%' class='right aligned'></td>"+
                      "<td width='30%' class='left aligned'><span class='sub1'>"+de2+"</span></td>"+
                      "<td width='50%' class='left aligned'>"+dataval2+"</td>"+
                      "<td width='7%' class='left aligned'>"+npibp2+"</td>"+
                      "<td width='10%' class='left aligned'>"+
                        // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel2+"' idv='"+v_idv2+"'>"+
                        //   "<option selected value='-'>-</option>"+
                        //   "<option value='OK'>OK</option>"+
                        //   "<option value='NOT OK'>NOT OK</option>"+
                        //   "<option disabled value='MODIF'>MODIF</option>"+
                        // "</select>"+

                        // "<label class='switch'>"+
                        //   "<input type='checkbox'>"+
                        //   "<span class='slider'></span>"+
                        // "</label>"+

                      // "<div class='ui tiny compact icon buttons'>"+
                      // "<a class='ui small gray circular label'>?</a>"+
                      // "<a class='ui small disabled circular label'>-</a>"+
                      // "<a class='ui small teal circular label'>OK</a>"+
                      "<input id='"+sel2+"' idv='"+v_idv2+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                      // "<div class='inline field'>"+
                      //   "<div class='ui toggle checkbox'>"+
                      //     "<input type='checkbox' tabindex='0' class='hidden'>"+
                      //     "<label></label>"+
                      //   "</div>"+
                      // "</div>"+


                        // "<button class='ui tiny link button dqajudgebtn'><i class='times icon'></i></button>"+
                      //   "<button class='ui tiny disabled button dqajudgebtn'><i class='minus icon'></i></button>"+
                      //   "<button class='ui green tiny link button '><i class='check icon'></i></button>"+
                      // "</div>"+


                      "</td>"+
                      "<td width='1%' class='right aligned'>"+reason2+"</td>"+
                    "</tr>"
                    );
                  }
                  // $('#'+sel2).val(v_res2); 
                  if (v_res2 ==="OK"){
                    $('#'+sel2).netlivaSwitch('state', true);
                  } else if (v_res2 ==="NOT OK"){
                    $('#'+sel2).netlivaSwitch('state', false);
                  }

                  if (v_res2 ==="-"){
                    $('#'+sel2).netlivaSwitch({
                      'active-color': '#a8a8f4',
                      'passive-color': '#a8a8f4',
                      'passive-text': '-',
                    });
                  }
                  if (v_res2 ==="MODIF"){
                    $('#'+sel2).netlivaSwitch({
                      'active-color': '#ece15e',
                      'passive-color': '#ece15e',
                      'passive-text': 'MOD',
                    });
                  }

                  


                }

              } else {
                $('.'+section+a).find("tbody").append(
                "<tr>"+
                  "<td width='1%' class='right aligned'></td>"+
                  "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub1'>"+de2+"</span></td>"+
                  "<td width='50%' class='left aligned'></td>"+
                  "<td width='7%' class='left aligned'></td>"+
                  "<td width='10%' class='left aligned' ></td>"+
                  "<td width='1%' class='left aligned' ></td>"+
                "</tr>"
                );
              }

              //List Level 3
              if (typeof obj["read_content"][a]['nodes'][b]['nodes'] !== 'undefined'){
                jmlDatac = obj["read_content"][a]['nodes'][b]['nodes'].length;
                for (c = 0; c < jmlDatac; c++) {
                  var id3 = obj["read_content"][a]['nodes'][b]['nodes'][c]['c_id'];
                  var de3 = obj["read_content"][a]['nodes'][b]['nodes'][c]['c_name'];
                  var at3 = obj["read_content"][a]['nodes'][b]['nodes'][c]['c_attrib'];
                  var in3 = obj["read_content"][a]['nodes'][b]['nodes'][c]['c_input'];
                  var op3 = obj["read_content"][a]['nodes'][b]['nodes'][c]['c_option'];
                  var do3 = obj["read_content"][a]['nodes'][b]['nodes'][c]['c_docs'];
                  var ad3 = do3.split(',');
                  var npibp = do3.replace(",", "&nbsp;&nbsp;|&nbsp;&nbsp;");
                  var npibp3 = "";
                  if(do3){
                    var npibp3 = "<div class='ui mini teal basic label TandaiNPI' idxx='"+id3+"' suppdocx='"+do3+"''>"+npibp+"</div>";
                  }

                  //Baca Value dari Json 'read_value' sesuai dengan content_id nya di level 3
                  var val3   = "";
                  var v_idv3 = "";
                  var v_res3 = "";
                  for (value_a = 0; value_a < jmlvalue; value_a++) {
                    var v_idc3 = obj["read_value"][value_a]['v_idcontent'];
                    if(id3 == v_idc3){
                      var val3    = obj["read_value"][value_a]['v_value'].replaceAll(";", ", ");
                      var v_idv3  = obj["read_value"][value_a]['v_id'];
                      var v_res3  = obj["read_value"][value_a]['v_result'];
                      var v_cek3  = obj["read_value"][value_a]['v_checker'];
                      var v_res3a = obj["read_value"][value_a]['v_result'];
                      
                      var v_reason3 = obj["read_value"][value_a]['reason'];
                      var reason3 = "<span class='AddNoteChecker SDD"+section+"' note='' id='"+v_idv3+"'><i class='sticky note outline disabled grey link icon'></i></span>";

                      if (v_reason3){
                      reason3 = "<span class='AddNoteChecker SDD"+section+"' note='"+v_reason3+"' id='"+v_idv3+"' data-tooltip='"+v_reason3+"' data-inverted='' data-variation='basic' data-position='top right'><i class='sticky note teal link icon'></i></span>";
                      }

                      if(!v_res3){
                        v_res3 = "-";
                      }
                      if(((VCY ==="C01") || (VEL ==="E01") || (VMD ==="M01") || (VID ==="I01")) && (v_res3 === "MODIF")){
                        v_res3 = "-";
                      }
                      if(v_res3 ==="MODIF" && v_cek3 === null){
                        v_res3 = "-";
                      }
                      if(v_res3a === "NOT OK" || (v_res3a === "MODIF" && v_cek3) || (val3 && v_res3a !== "OK")){
                        Finalresult++
                      }
                      break;

                    } else {
                      var v_cek3  = '';
                    }
                  }

                  //Tampilkan jika data tersebut untuk Suppoert Document NPI/BP
                  if(($.inArray('NPI', ad3) > -1) && val3){
                    var doc13 = "<div class='ui mini circular label teal'>NPI</div>"; 
                  } else {
                    var doc13 = "";
                  }
                  if(($.inArray('BP', ad3) > -1) && val3){
                    var doc23 = "<div class='ui mini circular label'>BP</div>"; 
                  } else {
                    var doc23 = "";
                  }


                  var sel3 = "SelectLv3"+id3;
                  if((at3==="YES")){

                    var coloritem = "#fff";
                    if(v_res3 === "-"){
                      var coloritem = "#efeffe";
                    }
                    if(v_res3 === "NOT OK"){
                      var coloritem = "#ffe3e3";
                    }
                    if(v_res3 === "MODIF"){
                      var coloritem = "#ffffea";
                    }
                    
                    if((val3 === '' || val3 === null || typeof val3 === 'undefined') && !v_cek3 ){

                      $('.'+section+a).find("tbody").append(
                        "<tr>"+
                          "<td width='1%' class='right aligned'></td>"+
                          "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub2'>"+de3+"</span></td>"+
                          "<td width='50%' class='left aligned'><i style='color: #ccc;'>empty_value - no need verification</i></td>"+
                          "<td width='7%' class='left aligned'></td>"+
                          "<td width='10%' class='left aligned' ></td>"+
                          "<td width='1%' class='left aligned' ></td>"+
                        "</tr>"
                        );
    
                    } else {

                      if(in3==="IMAGE"){
                        if (val3 ===""){
                          var dataimage3 = "<i style='color: #ccc;'>empty_image</i>";
                        } else {
                          var dataimage3 = "<img width='350' src='../RND_Upload/ProductSpec/"+val3+"'>";
                        }
                        $('.'+section+a).find("tbody").append(
                        "<tr style='background-color: "+coloritem+";'>"+
                          "<td width='1%' class='right aligned'></td>"+
                          "<td width='30%' class='left aligned'><span class='sub2'>"+de3+"</span></td>"+
                          "<td width='50%' class='left aligned'>"+dataimage3+"</td>"+
                          "<td width='7%' class='left aligned'>"+npibp3+"</td>"+
                          "<td width='10%' class='left aligned' >"+
                            // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel3+"' idv='"+v_idv3+"'>"+
                            //   "<option selected value='-'>-</option>"+
                            //   "<option value='OK'>OK</option>"+
                            //   "<option value='NOT OK'>NOT OK</option>"+
                            //   "<option disabled value='MODIF'>MODIF</option>"+
                            // "</select>"+

                            "<input id='"+sel3+"' idv='"+v_idv3+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                          "</td>"+
                          "<td width='1%' class='right aligned'>"+reason3+"</td>"+
                        "</tr>"
                        );
                      } else if(in3==="FILE"){
                        if (val3 ===""){
                          var datafile3 = "Belum upload file yang dimaksud.";
                        } else {
                          var datafile3 = "<a href='../RND_Upload/ProductSpec/"+val3+"' target='_blank'>"+val3+"</a>";
                        }
                        $('.'+section+a).find("tbody").append(
                        "<tr style='background-color: "+coloritem+";'>"+
                          "<td width='1%' class='right aligned'></td>"+
                          "<td width='30%' class='left aligned'><span class='sub2'>"+de3+"</span></td>"+
                          "<td width='50%' class='left aligned'>"+datafile3+"</td>"+
                          "<td width='7%' class='left aligned'>"+npibp3+"</td>"+
                          "<td width='10%' class='left aligned' >"+
                            // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel3+"' idv='"+v_idv3+"'>"+
                            //   "<option selected value='-'>-</option>"+
                            //   "<option value='OK'>OK</option>"+
                            //   "<option value='NOT OK'>NOT OK</option>"+
                            //   "<option disabled value='MODIF'>MODIF</option>"+
                            // "</select>"+
                            
                            "<input id='"+sel3+"' idv='"+v_idv3+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                          "</td>"+
                          "<td width='1%' class='right aligned'>"+reason3+"</td>"+
                        "</tr>"
                        );
                      } else {
                        if (val3 ===""){
                          var dataval3 = "<i style='color: #ccc;'>set to empty value</i>";
                        } else {
                          var dataval3 = val3;
                        }
                        $('.'+section+a).find("tbody").append(
                        "<tr style='background-color: "+coloritem+";'>"+
                          "<td width='1%' class='right aligned'></td>"+
                          "<td width='30%' class='left aligned'><span class='sub2'>"+de3+"</span></td>"+
                          "<td width='50%' class='left aligned'>"+dataval3+"</td>"+
                          "<td width='7%' class='left aligned'>"+npibp3+"</td>"+
                          "<td width='10%' class='left aligned' >"+
                            // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel3+"' idv='"+v_idv3+"'>"+
                            //   "<option selected value='-'>-</option>"+
                            //   "<option value='OK'>OK</option>"+
                            //   "<option value='NOT OK'>NOT OK</option>"+
                            //   "<option disabled value='MODIF'>MODIF</option>"+
                            // "</select>"+

                            "<input id='"+sel3+"' idv='"+v_idv3+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                          "</td>"+
                          "<td width='1%' class='right aligned'>"+reason3+"</td>"+
                        "</tr>"
                        );
                      }
                      // $('#'+sel3).val(v_res3);
                      if (v_res3 ==="OK"){
                        $('#'+sel3).netlivaSwitch('state', true);
                      } else if (v_res3 ==="NOT OK"){
                        $('#'+sel3).netlivaSwitch('state', false);
                      } 
                      if (v_res3 ==="-"){
                        $('#'+sel3).netlivaSwitch({
                          'active-color': '#a8a8f4',
                          'passive-color': '#a8a8f4',
                          'passive-text': '-',
                        });
                      }
                      if (v_res3 ==="MODIF"){
                        $('#'+sel3).netlivaSwitch({
                          'active-color': '#ece15e',
                          'passive-color': '#ece15e',
                          'passive-text': 'MOD',
                        });
                      }
                      
                    }

                  } else {
                    $('.'+section+a).find("tbody").append(
                    "<tr>"+
                      "<td width='1%' class='right aligned'></td>"+
                      "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub2'>"+de3+"</span></td>"+
                      "<td width='50%' class='left aligned'></td>"+
                      "<td width='7%' class='left aligned'></td>"+
                      "<td width='10%' class='left aligned' ></td>"+
                      "<td width='1%' class='left aligned' ></td>"+
                    "</tr>"
                    );
                  }


                  //List Level 4
                  if (typeof obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'] !== 'undefined'){
                    jmlDatad = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'].length;
                    for (d = 0; d < jmlDatad; d++) {
                      var id4 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['c_id'];
                      var de4 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['c_name'];
                      var at4 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['c_attrib'];
                      var in4 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['c_input'];
                      var op4 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['c_option'];
                      var do4 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['c_docs'];
                      var ad4 = do4.split(',');
                      var npibp = do4.replace(",", "&nbsp;&nbsp;|&nbsp;&nbsp;");
                      var npibp4 = "";
                      if(do4){
                        var npibp4 = "<div class='ui mini teal basic label TandaiNPI' idxx='"+id4+"' suppdocx='"+do4+"''>"+npibp+"</div>";
                      }

                      //Baca Value dari Json 'read_value' sesuai dengan content_id nya di level 4
                      var val4   = "";
                      var v_idv4 = "";
                      var v_res4 = "";
                      for (value_a = 0; value_a < jmlvalue; value_a++) {
                        var v_idc4 = obj["read_value"][value_a]['v_idcontent'];
                        if(id4 == v_idc4){
                          var val4    = obj["read_value"][value_a]['v_value'].replaceAll(";", ", ");
                          var v_idv4  = obj["read_value"][value_a]['v_id'];
                          var v_res4  = obj["read_value"][value_a]['v_result'];
                          var v_cek4  = obj["read_value"][value_a]['v_checker'];
                          var v_res4a = obj["read_value"][value_a]['v_result'];

                          var v_reason4 = obj["read_value"][value_a]['reason'];
                          var reason4 = "<span class='AddNoteChecker SDD"+section+"' note='' id='"+v_idv4+"'><i class='sticky note outline disabled grey link icon'></i></span>";

                          if (v_reason4){
                          reason4 = "<span class='AddNoteChecker SDD"+section+"' note='"+v_reason4+"' id='"+v_idv4+"' data-tooltip='"+v_reason4+"' data-inverted='' data-variation='basic' data-position='top right'><i class='sticky note teal link icon'></i></span>";
                          }

                          if(!v_res4){
                            v_res4 = "-";
                          }
                          if(((VCY ==="C01") || (VEL ==="E01") || (VMD ==="M01") || (VID ==="I01")) && (v_res4 === "MODIF")){
                            v_res4 = "-";
                          }
                          if(v_res4 ==="MODIF" && v_cek4 === null){
                            v_res4 = "-";
                          }
                          if(v_res4a === "NOT OK" || (v_res4a === "MODIF" && v_cek4) || (val4 && v_res4a !== "OK")){
                            Finalresult++
                          }
                          break;

                        } else {
                          var v_cek4  = '';
                        }
                      }

                      //Tampilkan jika data tersebut untuk Suppoert Document NPI/BP
                      if(($.inArray('NPI', ad4) > -1) && val4){
                        var doc14 = "<div class='ui mini circular label teal'>NPI</div>"; 
                      } else {
                        var doc14 = "";
                      }
                      if(($.inArray('BP', ad4) > -1) && val4){
                        var doc24 = "<div class='ui mini circular label'>BP</div>"; 
                      } else {
                        var doc24 = "";
                      }

                      var sel4 = "SelectLv4"+id4;
                      if((at4==="YES")){

                        var coloritem = "#fff";
                        if(v_res4 === "-"){
                          var coloritem = "#efeffe";
                        }
                        if(v_res4 === "NOT OK"){
                          var coloritem = "#ffe3e3";
                        }
                        if(v_res4 === "MODIF"){
                          var coloritem = "#ffffea";
                        }

                        if((val4 === '' || val4 === null || typeof val4 === 'undefined') && !v_cek4 ){

                          $('.'+section+a).find("tbody").append(
                            "<tr>"+
                              "<td width='1%' class='right aligned'></td>"+
                              "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub3'>"+de4+"</span></td>"+
                              "<td width='50%' class='left aligned'><i style='color: #ccc;'>empty_value - no need verification</i></td>"+
                              "<td width='7%' class='left aligned'></td>"+
                              "<td width='10%' class='left aligned' ></td>"+
                              "<td width='1%' class='left aligned' ></td>"+
                            "</tr>"
                            );
        
                        } else {

                          if(in4==="IMAGE"){
                            if (val4 ===""){
                              var dataimage4 = "<i style='color: #ccc;'>empty_image</i>";
                            } else {
                              var dataimage4 = "<img width='350' src='../RND_Upload/ProductSpec/"+val4+"'>";
                            }
                            $('.'+section+a).find("tbody").append(
                            "<tr style='background-color: "+coloritem+";'>"+
                              "<td width='1%' class='right aligned'></td>"+
                              "<td width='30%' class='left aligned'><span class='sub3'>"+de4+"</span></td>"+
                              "<td width='50%' class='left aligned'>"+dataimage4+"</td>"+
                              "<td width='7%' class='left aligned'>"+npibp4+"</td>"+
                              "<td width='10%' class='left aligned' >"+
                                // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel4+"' idv='"+v_idv4+"'>"+
                                //   "<option selected value='-'>-</option>"+
                                //   "<option value='OK'>OK</option>"+
                                //   "<option value='NOT OK'>NOT OK</option>"+
                                //   "<option disabled value='MODIF'>MODIF</option>"+
                                // "</select>"+
                                "<input id='"+sel4+"' idv='"+v_idv4+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                              "</td>"+
                              "<td width='1%' class='right aligned'>"+reason4+"</td>"+
                            "</tr>"
                            );
                          } else if(in4==="FILE"){
                            if (val4 ===""){
                              var datafile4 = "Belum upload file yang dimaksud.";
                            } else {
                              var datafile4 = "<a href='../RND_Upload/ProductSpec/"+val4+"' target='_blank'>"+val4+"</a>";
                            }
                            $('.'+section+a).find("tbody").append(
                            "<tr style='background-color: "+coloritem+";'>"+
                              "<td width='1%' class='right aligned'></td>"+
                              "<td width='30%' class='left aligned'><span class='sub3'>"+de4+"</span></td>"+
                              "<td width='50%' class='left aligned'>"+datafile4+"</td>"+
                              "<td width='7%' class='left aligned'>"+npibp4+"</td>"+
                              "<td width='10%' class='left aligned' >"+
                                // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel4+"' idv='"+v_idv4+"'>"+
                                //   "<option selected value='-'>-</option>"+
                                //   "<option value='OK'>OK</option>"+
                                //   "<option value='NOT OK'>NOT OK</option>"+
                                //   "<option disabled value='MODIF'>MODIF</option>"+
                                // "</select>"+
                                "<input id='"+sel4+"' idv='"+v_idv4+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                              "</td>"+
                              "<td width='1%' class='right aligned'>"+reason4+"</td>"+
                            "</tr>"
                            );
                          } else {
                            if (val4 ===""){
                              var dataval4 = "<i style='color: #ccc;'>set to empty value</i>";
                            } else {
                              var dataval4 = val4;
                            }
                            $('.'+section+a).find("tbody").append(
                            "<tr style='background-color: "+coloritem+";'>"+
                              "<td width='1%' class='right aligned'></td>"+
                              "<td width='30%' class='left aligned'><span class='sub3'>"+de4+"</span></td>"+
                              "<td width='50%' class='left aligned'>"+dataval4+"</td>"+
                              "<td width='7%' class='left aligned'>"+npibp4+"</td>"+
                              "<td width='10%' class='left aligned' >"+
                                // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel4+"' idv='"+v_idv4+"'>"+
                                //   "<option selected value='-'>-</option>"+
                                //   "<option value='OK'>OK</option>"+
                                //   "<option value='NOT OK'>NOT OK</option>"+
                                //   "<option disabled value='MODIF'>MODIF</option>"+
                                // "</select>"+
                                "<input id='"+sel4+"' idv='"+v_idv4+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                              "</td>"+
                              "<td width='1%' class='right aligned'>"+reason4+"</td>"+
                            "</tr>"
                            );
                          }
                          // $('#'+sel4).val(v_res4);
                          if (v_res4 ==="OK"){
                            $('#'+sel4).netlivaSwitch('state', true);
                          } else if (v_res4 ==="NOT OK"){
                            $('#'+sel4).netlivaSwitch('state', false);
                          }
                          if (v_res4 ==="-"){
                            $('#'+sel4).netlivaSwitch({
                              'active-color': '#a8a8f4',
                              'passive-color': '#a8a8f4',
                              'passive-text': '-',
                            });
                          }
                          if (v_res4 ==="MODIF"){
                            $('#'+sel4).netlivaSwitch({
                              'active-color': '#ece15e',
                              'passive-color': '#ece15e',
                              'passive-text': 'MOD',
                            });
                          }

                        }

                      } else {
                        $('.'+section+a).find("tbody").append(
                        "<tr>"+
                          "<td width='1%' class='right aligned'></td>"+
                          "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub3'>"+de4+"</span></td>"+
                          "<td width='50%' class='left aligned'></td>"+
                          "<td width='7%' class='left aligned'></td>"+
                          "<td width='10%' class='left aligned' ></td>"+
                          "<td width='1%' class='left aligned' ></td>"+
                        "</tr>"
                        );
                      }

                      //List Level 5
                      if (typeof obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'] !== 'undefined'){
                        jmlDatae = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'].length;
                        for (e = 0; e < jmlDatae; e++) {
                          var id5 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'][e]['c_id'];
                          var de5 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'][e]['c_name'];
                          var at5 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'][e]['c_attrib'];
                          var in5 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'][e]['c_input'];
                          var op5 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'][e]['c_option'];
                          var do5 = obj["read_content"][a]['nodes'][b]['nodes'][c]['nodes'][d]['nodes'][e]['c_docs'];
                          var ad5 = do5.split(',');
                          var npibp = do5.replace(",", "&nbsp;&nbsp;|&nbsp;&nbsp;");
                          var npibp5 = "";
                          if(do5){
                            var npibp5 = "<div class='ui mini teal basic label TandaiNPI' idxx='"+id5+"' suppdocx='"+do5+"''>"+npibp+"</div>";
                          }

                          //Baca Value dari Json 'read_value' sesuai dengan content_id nya di level 5
                          var val5   = "";
                          var v_idv5 = "";
                          var v_res5 = "";
                          for (value_a = 0; value_a < jmlvalue; value_a++) {
                            var v_idc5 = obj["read_value"][value_a]['v_idcontent'];
                            if(id5 == v_idc5){
                              var val5    = obj["read_value"][value_a]['v_value'].replaceAll(";", ", ");
                              var v_idv5  = obj["read_value"][value_a]['v_id'];
                              var v_res5  = obj["read_value"][value_a]['v_result'];
                              var v_cek5  = obj["read_value"][value_a]['v_checker'];
                              var v_res5a = obj["read_value"][value_a]['v_result'];

                              var v_reason5 = obj["read_value"][value_a]['reason'];
                              var reason5 = "<span class='AddNoteChecker SDD"+section+"' note='' id='"+v_idv5+"'><i class='sticky note outline disabled grey link icon'></i></span>";

                              if (v_reason5){
                              reason5 = "<span class='AddNoteChecker SDD"+section+"' note='"+v_reason5+"' id='"+v_idv5+"' data-tooltip='"+v_reason5+"' data-inverted='' data-variation='basic' data-position='top right'><i class='sticky note teal link icon'></i></span>";
                              }

                              if(!v_res5){
                                v_res5 = "-";
                              }
                              
                              if(((VCY ==="C01") || (VEL ==="E01") || (VMD ==="M01") || (VID ==="I01")) && (v_res5 === "MODIF")){
                                v_res5 = "-";
                              }
                              
                              if(v_res5 ==="MODIF" && v_cek5 === null){
                                v_res5 = "-";
                              }

                              if(v_res5a === "NOT OK" || (v_res5a === "MODIF" && v_cek5) || (val5 && v_res5a !== "OK")){
                                Finalresult++
                              }
                              break;

                            } else {
                              var v_cek5  = '';
                            }
                          }

                           //Tampilkan jika data tersebut untuk Suppoert Document NPI/BP
                           if(($.inArray('NPI', ad5) > -1) && val5){
                            var doc15 = "<div class='ui mini circular label teal'>NPI</div>"; 
                          } else {
                            var doc15 = "";
                          }
                          if(($.inArray('NPI', ad5) > -1) && val5){
                            var doc25 = "<div class='ui mini circular label'>BP</div>"; 
                          } else {
                            var doc25 = "";
                          }

                          var sel5 = "SelectLv5"+id5;
                          if((at5==="YES")){

                            var coloritem = "#fff";
                            if(v_res5 === "-"){
                              var coloritem = "#efeffe";
                            }
                            if(v_res5 === "NOT OK"){
                              var coloritem = "#ffe3e3";
                            }
                            if(v_res5 === "MODIF"){
                              var coloritem = "#ffffea";
                            }

                            if((val5 === '' || val5 === null || typeof val5 === 'undefined') && !v_cek5 ){

                              $('.'+section+a).find("tbody").append(
                                "<tr>"+
                                  "<td width='1%' class='right aligned'></td>"+
                                  "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub4'>"+de5+"</span></td>"+
                                  "<td width='50%' class='left aligned'><i style='color: #ccc;'>empty_value - no need verification</i></td>"+
                                  "<td width='7%' class='left aligned'></td>"+
                                  "<td width='10%' class='left aligned' ></td>"+
                                  "<td width='1%' class='left aligned' ></td>"+
                                "</tr>"
                                );
            
                            } else {

                              if(in5==="IMAGE"){
                                if (val5 ===""){
                                  var dataimage5 = "<i style='color: #ccc;'>empty_image</i>";
                                } else {
                                  var dataimage5 = "<img width='350' src='../RND_Upload/ProductSpec/"+val5+"'>";
                                }
                                $('.'+section+a).find("tbody").append(
                                "<tr style='background-color: "+coloritem+";'>"+
                                  "<td width='1%' class='right aligned'></td>"+
                                  "<td width='30%' class='left aligned'><span class='sub4'>"+de5+"</span></td>"+
                                  "<td width='50%' class='left aligned'>"+dataimage5+"</td>"+
                                  "<td width='7%' class='left aligned'>"+npibp5+"</td>"+
                                  "<td width='10%' class='left aligned' >"+
                                    // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel5+"' idv='"+v_idv5+"'>"+
                                    //   "<option selected value='-'>-</option>"+
                                    //   "<option value='OK'>OK</option>"+
                                    //   "<option value='NOT OK'>NOT OK</option>"+
                                    //   "<option disabled value='MODIF'>MODIF</option>"+
                                    // "</select>"+
                                    "<input id='"+sel5+"' idv='"+v_idv5+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                                  "</td>"+
                                  "<td width='1%' class='right aligned'>"+reason5+"</td>"+
                                "</tr>"
                                );
                              } else if(in5==="FILE"){
                                if (val5 ===""){
                                  var datafile5 = "Belum upload file yang dimaksud.";
                                } else {
                                  var datafile5 = "<a href='../RND_Upload/ProductSpec/"+val5+"' target='_blank'>"+val5+"</a>";
                                }
                                $('.'+section+a).find("tbody").append(
                                "<tr style='background-color: "+coloritem+";'>"+
                                  "<td width='1%' class='right aligned'></td>"+
                                  "<td width='30%' class='left aligned'><span class='sub4'>"+de5+"</span></td>"+
                                  "<td width='50%' class='left aligned'>"+datafile5+"</td>"+
                                  "<td width='7%' class='left aligned'>"+npibp5+"</td>"+
                                  "<td width='10%' class='left aligned' >"+
                                    // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel5+"' idv='"+v_idv5+"'>"+
                                    //   "<option selected value='-'>-</option>"+
                                    //   "<option value='OK'>OK</option>"+
                                    //   "<option value='NOT OK'>NOT OK</option>"+
                                    //   "<option disabled value='MODIF'>MODIF</option>"+
                                    // "</select>"+
                                    "<input id='"+sel5+"' idv='"+v_idv5+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                                  "</td>"+
                                  "<td width='1%' class='right aligned'>"+reason5+"</td>"+
                                "</tr>"
                                );
                              } else {
                                if (val5 ===""){
                                  var dataval5 = "<i style='color: #ccc;'>set to empty value</i>";
                                } else {
                                  var dataval5 = val5;
                                }
                                $('.'+section+a).find("tbody").append(
                                "<tr style='background-color: "+coloritem+";'>"+
                                  "<td width='1%' class='right aligned'></td>"+
                                  "<td width='30%' class='left aligned'><span class='sub4'>"+de5+"</span></td>"+
                                  "<td width='50%' class='left aligned'>"+dataval5+"</td>"+
                                  "<td width='7%' class='left aligned'>"+npibp5+"</td>"+
                                  "<td width='10%' class='left aligned' >"+
                                    // "<select class='selectpsc dropdownubahresult disabled DD"+section+"' id='"+sel5+"' idv='"+v_idv5+"'>"+
                                    //   "<option selected value='-'>-</option>"+
                                    //   "<option value='OK'>OK</option>"+
                                    //   "<option value='NOT OK'>NOT OK</option>"+
                                    //   "<option disabled value='MODIF'>MODIF</option>"+
                                    // "</select>"+
                                    "<input id='"+sel5+"' idv='"+v_idv5+"' disabled class='DQAJudqa DD"+section+"' type='checkbox' netliva-switch data-active-text='OK' data-passive-text='NG' data-width='60px' />"+

                                  "</td>"+
                                  "<td width='1%' class='right aligned'>"+reason5+"</td>"+
                                "</tr>"
                                );
                              }
                              // $('#'+sel5).val(v_res5);
                              if (v_res5 ==="OK"){
                                $('#'+sel5).netlivaSwitch('state', true);
                              } else if (v_res5 ==="NOT OK"){
                                $('#'+sel5).netlivaSwitch('state', false);
                              }
                              if (v_res5 ==="-"){
                                $('#'+sel5).netlivaSwitch({
                                  'active-color': '#a8a8f4',
                                  'passive-color': '#a8a8f4',
                                  'passive-text': '-',
                                });
                              }
                              if (v_res5 ==="MODIF"){
                                $('#'+sel5).netlivaSwitch({
                                  'active-color': '#ece15e',
                                  'passive-color': '#ece15e',
                                  'passive-text': 'MOD',
                                });
                              }

                            }

                          } else {
                            $('.'+section+a).find("tbody").append(
                            "<tr>"+
                              "<td width='1%' class='right aligned'></td>"+
                              "<td width='30%' class='left aligned' style='height: 32px;'><span class='sub4'>"+de5+"</span></td>"+
                              "<td width='50%' class='left aligned'></td>"+
                              "<td width='7%' class='left aligned'></td>"+
                              "<td width='10%' class='left aligned' ></td>"+
                              "<td width='1%' class='left aligned' ></td>"+
                            "</tr>"
                            );
                          }
                        }
                      }
                    }
                  }
                }
              }
             
            }
           
          } 
        }
      }
      FungsiTableContent();
      // console.log('ready_called');

      FungsiSaveValue();
      FungsiAddNote();
      

      if(Finalresult>0){
        var FResult = "NOT OK";
      } else {
        var FResult = "OK";
      }
      $("#FinalResult"+section).text(FResult);
      // console.log(section+": "+Finalresult);

    },
    error: function () {
      if (LogoutProtect){
        window.location.href = "./?link=loclogout";
      } else {
        Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
      }
    },
  });


}

$('#xwinbplengkap').click(function(){
    
  var sct = getCookie("section");
  var jbt = getCookie("jabatan");
  // console.log(pic);
  $.ajax({
    type    : "POST",
    url     : `../RND_BackEnd/backend_psc/load-bplengkap`,
    headers : {
      user  : vusrnm,
      token : vtoken
    },
    data: {
      type_supply    : tipe
    },
    cache: false,
    success: function (response){
      var obj = JSON.parse(response);
      $(".xwinbplengkap").modal({
        autofocus: false,
      }).modal("show");
      if(isEmpty(obj)) {
        IsResponseEmptyObj();
      } else {
        
        $("#ReportList").empty();
        // console.log(pic);
        jmlData = obj.length;
        console.log(obj);
        
        for (a = 0; a < jmlData; a++) {
          
            var filelink = "<a target='_blank' href='../RND_Upload/BP/BPLengkap/"+obj[a]["NamaFile"]+"'><i class='file pdf red icon'></i></a>";
            console.log(filelink);
            $("#TableReportList").find("tbody").append(
              "<tr>"+ 
              "<td width='20%'>"+obj[a]['no_bp']+"</td>"+
              "<td width='10%'>"+obj[a]['rev']+"</td>"+
              "<td width='30%'>"+obj[a]['note']+"</td>"+
              "<td width='20%'>"+obj[a]['Date']+"</td>"+
              "<td width='20%'>"+filelink+"</td>"+
              "</tr><tr></tr>"
            );
             
        }
        $("#FootFeedCheckList").empty();
          
       
        
      }
    }
});
// $("#PSCRejectSection").dropdown("clear");
});

//Head Of DQA Confirm
$('#BtnSignHOD').click(function(){
  var nm = $(this).attr('nm');
  var sts = $('#StsSignHOD').val();
  if (sts ===""){
    Swal.fire({
      title: "<h3>Confirm Product Spec ini ?</h3>",
      confirmButtonText: "Ya",
      showCancelButton: true,
    }).then((result) => {
      if (result.value) {
        $.ajax({
          type: "POST",
          url: `${restlocpsc}sign_dqa`,
          headers: {
            user: vusrnm,
            token: vtoken,
          },
          data: {
            id_psc  : idpsc,
            pic     : nm
          },
          cache: false,
          success: function (response) {
            var obj = JSON.parse(response);
            if (obj.status == false) {
              Swal.fire(
                "Error",
                "Ada kendal di koneksi/database, data tidak tersimpan !",
                "error"
              );
            } else {
              Swal.fire({
                title: "Confirmed!",
                timer: 1500,
                icon: "success",
                showConfirmButton: false,
              });
              LoadDataSign();
            }
          },
          error: function () {
            if (LogoutProtect){
              window.location.href = "./?link=loclogout";
            } else {
              Swal.fire("Error", "Server tidak merespon, segera hubungi Administrator di ext. 3553 !","error" );
            }
          },
        });
      }
    });
  }
});

function FungsiAddNote(){
  $('.AddNoteChecker').click(function(){
    var Id_val = $(this).attr('id');
    var Note_val = $(this).attr('note');
    $(".xwinaddnotechecker").modal({ autofocus: false, }).modal("show");
    $("#IdValueNote").val(Id_val);
    $("#NoteChecker").val(Note_val);
  });
}

$(document).ready(function () {

  LoadDataSign();

  if(groupprd =="BROWN GOODS"){
    LoadDataContent('ELECTRONIC');
    LoadDataPICDQA('ELECTRONIC');
  } else {
    LoadDataContent('CYCLE');
    LoadDataContent('ELECTRONIC');
    LoadDataPICDQA('CYCLE');
    LoadDataPICDQA('ELECTRONIC');
  }
  LoadDataContent('MD');
  LoadDataContent('ID');
  LoadDataPICDQA('MD');
  LoadDataPICDQA('ID');


  $('#cyclepic_e').text(pic_c);
  $('#electpic_e').text(pic_e);
  $('#mdpic_e').text(pic_m);
  $('#idpic_e').text(pic_i);

  $('#headofgrouppic').text(pic_hog);
  $('#plpic').text(pic_pl);
  $('#headofdqapic').text(pic_hod);

  $('#tabpsclist').on('click', function() {
    window.location.href = "./?link=pscindex";
  });

  $('#BtnEditHeader').on('click', function() {
    var idx = $(this).attr('idpsc');
    window.location.href = "./?link=pscheader&i="+idx;
  });

  $('.tabuserguide').on('click', function() {
    window.location.href = "./?link=guidepsc";
  });
  $('.tabsuratgolive').on('click', function() {
    window.location.href = "./?link=golivepsc";
  });
  $('.tabhasilmonitoring').on('click', function() {
    window.location.href = "./?link=monitorpsc";
  });
  $('.tabversion').on('click', function() {
    window.location.href = "./?link=versionhistory&app=PSC";
  });
  
});




// Fungsi untuk fungsi yang di dalam Table Content
function FungsiTableContent(){

  $('.ui.accordion').accordion(
    {exclusive : false}
  );

}


 

// saving psc value -------------------------------------------
function FungsiSaveValue(){
  // console.log('called');
  // $('.ui.accordion').accordion({exclusive : false});
  // $('.dropdownubahresult').on('change', function() {
  //   var idv   = $(this).attr("idv");
  //   var vin   = $(this).val();
  //   $.ajax({
  //     url: `${restlocpsc}saveresult`,
  //     type: "POST",
  //     headers: {
  //       user: vusrnm,
  //       token: vtoken,
  //     },
  //     data: {
  //       id_psc  : idpsc,
  //       v_id    : idv,
  //       v_result: vin,
  //     },
  //     success: function (data) {
  //       var obj = JSON.parse(data);
  //       if (obj.status == false) {
  //         if(obj.code == 'logout'){
  //           window.location.href = "./?link=loclogout";
  //         } else {
  //           Swal.fire({
  //             text: "Not Saved - Wrong Judgement",
  //             timer: 1000,
  //             toast: true,
  //             showConfirmButton: false,
  //             position: 'center'
  //           });
  //         }
  //       } else {
  //         Swal.fire({
  //           text: "Saved",
  //           timer: 1000,
  //           toast: true,
  //           showConfirmButton: false,
  //           showClass: {
  //             backdrop: 'swal2-noanimation', // disable backdrop animation
  //             popup: '',                     // disable popup animation
  //             icon: ''                       // disable icon animation
  //           },
  //           position: 'bottom'
  //         });
  //         if(groupprd =="BROWN GOODS"){
  //           LoadDataContent('ELECTRONIC');
  //           LoadDataPICDQA('ELECTRONIC');
  //         } else {
  //           LoadDataContent('CYCLE');
  //           LoadDataContent('ELECTRONIC');
  //           LoadDataPICDQA('CYCLE');
  //           LoadDataPICDQA('ELECTRONIC');
  //         }
  //         LoadDataContent('MD');
  //         LoadDataContent('ID');
  //         LoadDataPICDQA('MD');
  //         LoadDataPICDQA('ID');
  //       }
  //     }
  //   })
  // });


  $(".DQAJudqa").on('netlivaSwitch.change', function(event, state, element) {
    var idv   = $(this).attr("idv");
    var vin   = "NOT OK";
    $(this).closest("tr").css("background-color", "#ffe3e3");

    if(state){
      var vin   = "OK";
      $(this).closest("tr").css("background-color", "#fff");
    }

    // var currentRow=$(this).closest("tr");

    // $(this).closest("tr").attr('style') == 'background-color:rgba(217,244,252,1);';

    // console.log(currentRow);


    $(this).netlivaSwitch({
      'active-color': '#b6cba3',
      'passive-color': '#f77c7c',
      'passive-text': 'NG',
    });

    $.ajax({
      url: `${restlocpsc}saveresult`,
      type: "POST",
      headers: {
        user: vusrnm,
        token: vtoken,
      },
      data: {
        id_psc  : idpsc,
        v_id    : idv,
        v_result: vin,
      },
      success: function (data) {
        var obj = JSON.parse(data);
        if (obj.status == false) {
          if(obj.code == 'logout'){
            window.location.href = "./?link=loclogout";
          } else {
            Swal.fire({
              text: "Not Saved - Wrong Judgement",
              timer: 1000,
              toast: true,
              showConfirmButton: false,
              position: 'center'
            });
          }
        } else {
          Swal.fire({
            text: "Saved",
            timer: 1000,
            toast: true,
            showConfirmButton: false,
            showClass: {
              backdrop: 'swal2-noanimation', // disable backdrop animation
              popup: '',                     // disable popup animation
              icon: ''                       // disable icon animation
            },
            // position: 'bottom'
          });

          if(groupprd =="BROWN GOODS"){
          //   LoadDataContent('ELECTRONIC');
            LoadDataPICDQA('ELECTRONIC');
          } else {
          //   LoadDataContent('CYCLE');
          //   LoadDataContent('ELECTRONIC');
            LoadDataPICDQA('CYCLE');
            LoadDataPICDQA('ELECTRONIC');
          }
          // LoadDataContent('MD');
          // LoadDataContent('ID');
          LoadDataPICDQA('MD');
          LoadDataPICDQA('ID');
        }
      }
    })

  });

}

function FungsiSignPIC(){

  $('.BtnSignPIC').on('click', function() {
    var idcheck = $(this).attr("idchk");
    var sect    = $(this).attr("sect");
    Swal.fire({
      title: "<h3>Sign Product Spec ini?</h3>",
      confirmButtonText: "Ya",
      showCancelButton: true,
    }).then((result) => {
      if (result.value) {
        $.ajax({
          url: `${restlocpsc}signchecker`,
          type: "POST",
          headers: {
            user: vusrnm,
            token: vtoken,
          },
          data: {
            id_checker  : idcheck,
            PSCId       : idpsc,
            section     : sect
          },
          success: function (data) {
            var obj = JSON.parse(data);
            Swal.fire({
              text: "Signed",
              timer: 500,
              toast: true,
              showConfirmButton: false,
              showClass: {
                backdrop: 'swal2-noanimation', // disable backdrop animation
                popup: '',                     // disable popup animation
                icon: ''                       // disable icon animation
              },
              position: 'bottom'
            });
            window.location.href = "./?link=psccontent&i="+idenc;
          }
        })
      }
    });
  });
}





$('#SaveCheckerNote').on('click', function() {
    var id_val = $("#IdValueNote").val();
    var note   = $("#NoteChecker").val();  

    $.ajax({
      url: `${restlocpsc}save_note`,
      type: "POST",
      headers: {
        user: vusrnm,
        token: vtoken,
      },
      data: {
        v_id  : id_val,
        note  : note,
      },
      success: function (data) {
        var obj = JSON.parse(data);
        Swal.fire({
          text: "Saved",
          timer: 500,
          toast: true,
          showConfirmButton: false,
          showClass: {
            backdrop: 'swal2-noanimation', // disable backdrop animation
            popup: '',                     // disable popup animation
            icon: ''                       // disable icon animation
          },
          position: 'bottom'
        });

        $(".xwinaddnotechecker").modal("hide");
        if(groupprd =="BROWN GOODS"){
            LoadDataContent('ELECTRONIC');
            LoadDataPICDQA('ELECTRONIC');
          } else {
            LoadDataContent('CYCLE');
            LoadDataContent('ELECTRONIC');
            LoadDataPICDQA('CYCLE');
            LoadDataPICDQA('ELECTRONIC');
          }
          LoadDataContent('MD');
          LoadDataContent('ID');
          LoadDataPICDQA('MD');
          LoadDataPICDQA('ID');
      }
    })

  });

//-------------------------------------------------------

$('.CancelData').click(function(){
  $(".xwinuploadpic").modal("hide");
  $(".xwinaddchild-main").modal("hide");
  $(".xwinaddchild").modal("hide");
  $(".xwinengineersign").modal("hide");
  $(".xwinrejecthog").modal("hide");
  $(".xwinrejectpl").modal("hide");
  $('.ui.accordion').accordion({exclusive : false});
  $(".xwinsortgroup").modal("hide");
  $(".xwinsortgroupL2").modal("hide");
  $(".xwinaddnotechecker").modal("hide");
});
