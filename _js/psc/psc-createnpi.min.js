$(".ui.dropdown").dropdown();
$(".menu .item").tab();
$('.ui.accordion').accordion(
  {exclusive : false}
);

// Global Variable
const NonceValue = "rdsystem2020";
const LogoutProtect = true;

const ColorOwner  = "#00139f";
const ColorRelease= "#8d8d8d";

var vusrnm = getCookie("usrnm");
var vtoken = getCookie("token");
var restlocpsc = decodeURIComponent(getCookie("restlocpsc"));
let Ucrypt = new Encryption();
// var Udecrypt = Ucrypt.decrypt(EncU, NonceValue);


new Sortable(NPIText, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared',
  },
  // onEnd: function (event) {
  //   // var pscfrom = event.oldIndex;
  //   // var pscto = event.newIndex;
  //   // var psccontent = event.item.textContent;
  //   var psccate_from = event.from.id;
  //   // var psccate_to = event.to.id;
  //   var id_val = event.item.id;
  //   var PSCIdx = idpsc;
  //   console.log('---------------');
  //   console.log(psccate_from);
  //   console.log('id_val: '+id_val);
  //   console.log('psc_id: '+PSCIdx);
  // },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "NPIText";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npi`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
  
});


new Sortable(SPEC, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "SPEC";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npi`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});

new Sortable(POWER, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "POWER";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npi`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});



new Sortable(KEY, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "KEY";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npi`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});

new Sortable(DIMMENSION, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared',
  },

  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "DIMMENSION";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npi`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});

new Sortable(POSTEL, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "POSTEL";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npi`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});



new Sortable(NPIImage, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared2',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "NPIImage";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npiimage`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});




new Sortable(ImgA, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared2',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "ImgA";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npiimage`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});

new Sortable(ImgB, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared2',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "ImgB";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npiimage`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});

new Sortable(ImgC, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared2',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "ImgC";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npiimage`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});

new Sortable(ImgD, {
  animation: 350,
  ghostClass: 'chosen',
  dataIdAttr: 'id',
  group: {
    name: 'shared2',
  },
  store: {
    set: function (sortable) {
      var order = sortable.toArray();
      var PSCIdx = idpsc;
      var cate = "ImgD";
      // console.log('---------------');
      // console.log(cate);
      // console.log('psc_id: '+PSCIdx);
      // console.log('Order : '+order);
      $.ajax({
        url: `${restlocpsc}create_npiimage`,
        type: "POST",
        headers: {
          user: vusrnm,
          token: vtoken,
        },
        data: {
          cate    : cate,
          PSCId   : PSCIdx,
          order   : order,
        },
        success: function (response) {
        var obj = JSON.parse(response);
          if (obj.status == false) {
            Swal.fire(
              "Error",
              "Ada kendal di koneksi/database, data tidak tersimpan !",
              "error"
            );
          } else {
            Swal.fire({
              text: "Moved",
              timer: 1000,
              showConfirmButton: false,
              toast: true
            });
          }
        }
      })
    }
  }
});

// new Sortable(ImgE, {
//   animation: 350,
//   ghostClass: 'chosen',
//   dataIdAttr: 'id',
//   group: {
//     name: 'shared2',
//   },
//   store: {
//     set: function (sortable) {
//       var order = sortable.toArray();
//       var PSCIdx = idpsc;
//       var cate = "ImgE";
//       // console.log('---------------');
//       // console.log(cate);
//       // console.log('psc_id: '+PSCIdx);
//       // console.log('Order : '+order);
//       $.ajax({
//         url: `${restlocpsc}create_npiimage`,
//         type: "POST",
//         headers: {
//           user: vusrnm,
//           token: vtoken,
//         },
//         data: {
//           cate    : cate,
//           PSCId   : PSCIdx,
//           order   : order,
//         },
//         success: function (response) {
//         var obj = JSON.parse(response);
//           if (obj.status == false) {
//             Swal.fire(
//               "Error",
//               "Ada kendal di koneksi/database, data tidak tersimpan !",
//               "error"
//             );
//           } else {
//             Swal.fire({
//               text: "Moved",
//               timer: 1000,
//               showConfirmButton: false,
//               toast: true
//             });
//           }
//         }
//       })
//     }
//   }
// });



$(document).ready(function () {

  $('#tabpsclist').on('click', function() {
    window.location.href = "./?link=pscindex";
  });

  $('#tabcompare').on('click', function() {
    window.location.href = "./?link=psccompare";
  });

  $('#DownloadNPI').on('click', function() {
    window.location.href = `./1_productspec/createpptx.php?id=${idpsc}`;
  });

  $('.tabuserguide').on('click', function() {
    window.location.href = "./?link=guidepsc";
  });
  $('.tabsuratgolive').on('click', function() {
    window.location.href = "./?link=golivepsc";
  });
  $('.tabhasilmonitoring').on('click', function() {
    window.location.href = "./?link=monitorpsc";
  });
  $('.tabversion').on('click', function() {
    window.location.href = "./?link=versionhistory&app=PSC";
  });

});




// http://10.8.15.42/RND/1_productspec/createpptx.php